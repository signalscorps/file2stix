# Extractions: Observed Mode

Observed mode allows you to keep track of how many times you've seen an extraction accross multiple reports using an STIX 2.1 Observed Data SDO.

This mode will extract the same things as when Analysis mode is used ([see Analysis Mode](/extractions-analysis-mode.md)), however, will include the addition of STIX 2.1 Observed Data SDO.

## Observed Data SDOs (`observed-data`)

For every extraction type where an SCO is created (ipv4, ipv6, File name, File hash, Directory, Domain, URL, Email Address, MAC Address, Windows Registry Key, User Agent, Autonomous System Number, Cryptocurrency, IBAN, CPE, Credit Card) an Observed Data Object is also created for each unique SCO (note, if reusing old SCO a new Observed Data Object is not created, see following section).

```json
{
    "type": "observed-data",
    "spec_version": "2.1",
    "id": "observed-data--<GENERATED BY STIX2 LIBRARY>",
    "created_by_ref": "identity--<IF TLP RED/AMBER/GREEN USER IDENTITY ID>",
    "created": "<REPORT CREATED PROPERTY VALUE>",
    "modified": "<REPORT MODIFIED PROPERTY VALUE>",
    "first_observed": "<FIRST REPORT CREATED PROPERTY VALUE>",
    "last_observed": "<FIRST REPORT CREATED PROPERTY VALUE>",
    "number_observed": "<COUNT OF TIMES SCO APPEARS IN CURRENT REPORT>",
    "object_refs": [
      "<ID OF SCO SEEN>"
    ],
    "object_marking_refs": [
      "marking-definition--<TLP LEVEL SET>"
    ],
    "external_references": [
      {
        "source_name": "file2stix",
        "description": "This object was created using file2stix from the Signals Corps.",
        "url": "https://github.com/signalscorps/file2stix"
      }
    ]
}
```

The `number_observed` property counts the time an SCO is contained in a current report.
One final example; If 2 reports are uploaded as TLP Red and attributed to two different identities both containing the same Observable (with all other properties at upload the same) then 2 SCOs will be created, 2 Observed Data Objects will be created. Assuming these are the only 2 reports that contain this observable, then the `number_observed` will be 1 in each Observed Data Object.