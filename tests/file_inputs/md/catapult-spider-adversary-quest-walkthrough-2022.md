::: {data-id="wistia_player_embed"}
:::

::: {#modal-mask .modal_insert_location}
::: {.container}
::: {.row}
::: {.col-lg-12}
::: {#modal-inner-mask .modal_mask}
::: {.close_button}
:::

::: {#modal-insert .modal_content}
:::
:::
:::
:::
:::
:::

::: {#blogNavInsertLocation}
::: {.blog_main_navigation}
::: {.blog_main_navigation_top}
::: {.container}
::: {.row}
::: {.col-12}
-   [[]{.fa-solid .fa-magnifying-glass}]{#searchBlog}
-   [[]{.fa-brands .fa-twitter}](https://twitter.com/CrowdStrike)
-   [[]{.fa-brands .fa-facebook}](https://www.facebook.com/CrowdStrike)
-   [[]{.fa-brands
    .fa-linkedin}](https://www.linkedin.com/company/crowdstrike)
-   [[]{.fa-brands
    .fa-youtube}](https://www.youtube.com/user/CrowdStrike)
-   [[]{.fa .fa-envelope}](mailto:info@crowdstrike.com)
:::
:::
:::
:::

::: {.blog_main_navigation_bottom}
::: {.container}
::: {.row}
::: {.col-12 .d-flex .align-items-center .justify-content-between}
::: {.blog_main_navigation_bottom_site_logo .d-flex .align-items-center}
[![CrowdStrike](./catapult-spider-adversary-quest-walkthrough-2022_files/RedLogoCS.svg)](https://www.crowdstrike.com/){.crowdstrike_logo}
[BLOG](https://www.crowdstrike.com/blog/ "CrowdStrike Blog"){.blog_logo}
:::

-   [Featured](https://www.crowdstrike.com/blog/featured-articles/){.blog_navigation_right_li_header}
    -   [](https://www.crowdstrike.com/blog/why-xdr-should-be-on-your-soc-roadmap/)
        ::: {.image}
        ![](./catapult-spider-adversary-quest-walkthrough-2022_files/0622_02_RSA-Day3_MikeS_Blog_1060x698.jpeg)
        :::

        ::: {.d-flex .flex-column}
        ::: {.title}
        Why XDR Should Be on Your Roadmap for SOC Success
        :::

        ::: {.date}
        Aug 16, 2022
        :::
        :::
    -   [](https://www.crowdstrike.com/blog/crowdstrike-wins-frost-and-sullivans-global-technology-innovation-leadership-award/)
        ::: {.image}
        ![](./catapult-spider-adversary-quest-walkthrough-2022_files/0722_08_Tech-Innovation-Leadership-Award_R2_Blog_1060x698.jpeg)
        :::

        ::: {.d-flex .flex-column}
        ::: {.title}
        CrowdStrike Wins Technology Innovation Leadership Award,
        Continues Dominance in Endpoint Security Market
        :::

        ::: {.date}
        Aug 16, 2022
        :::
        :::
    -   [](https://www.crowdstrike.com/blog/the-anatomy-of-wiper-malware-part-1/)
        ::: {.image}
        ![](./catapult-spider-adversary-quest-walkthrough-2022_files/Blog_1060x698-1.jpeg)
        :::

        ::: {.d-flex .flex-column}
        ::: {.title}
        The Anatomy of Wiper Malware, Part 1: Common Techniques
        :::

        ::: {.date}
        Aug 12, 2022
        :::
        :::
    -   [](https://www.crowdstrike.com/blog/patch-tuesday-analysis-august-2022/)
        ::: {.image}
        ![](./catapult-spider-adversary-quest-walkthrough-2022_files/patch-tuesday-blog-1.jpg)
        :::

        ::: {.d-flex .flex-column}
        ::: {.title}
        August 2022 Patch Tuesday: 17 Critical CVEs and Two Zero-Days,
        One Under Active Exploitation
        :::

        ::: {.date}
        Aug 11, 2022
        :::
        :::
-   [Recent](https://www.crowdstrike.com/blog/recent-articles/){.blog_navigation_right_li_header}
    -   [](https://www.crowdstrike.com/blog/why-xdr-should-be-on-your-soc-roadmap/)
        ::: {.image}
        ![](./catapult-spider-adversary-quest-walkthrough-2022_files/0622_02_RSA-Day3_MikeS_Blog_1060x698.jpeg)
        :::

        ::: {.d-flex .flex-column}
        ::: {.title}
        Why XDR Should Be on Your Roadmap for SOC Success
        :::

        ::: {.date}
        Aug 16, 2022
        :::
        :::
    -   [](https://www.crowdstrike.com/blog/crowdstrike-wins-frost-and-sullivans-global-technology-innovation-leadership-award/)
        ::: {.image}
        ![](./catapult-spider-adversary-quest-walkthrough-2022_files/0722_08_Tech-Innovation-Leadership-Award_R2_Blog_1060x698.jpeg)
        :::

        ::: {.d-flex .flex-column}
        ::: {.title}
        CrowdStrike Wins Technology Innovation Leadership Award,
        Continues Dominance in Endpoint Security Market
        :::

        ::: {.date}
        Aug 16, 2022
        :::
        :::
    -   [](https://www.crowdstrike.com/blog/the-anatomy-of-wiper-malware-part-1/)
        ::: {.image}
        ![](./catapult-spider-adversary-quest-walkthrough-2022_files/Blog_1060x698-1.jpeg)
        :::

        ::: {.d-flex .flex-column}
        ::: {.title}
        The Anatomy of Wiper Malware, Part 1: Common Techniques
        :::

        ::: {.date}
        Aug 12, 2022
        :::
        :::
    -   [](https://www.crowdstrike.com/blog/patch-tuesday-analysis-august-2022/)
        ::: {.image}
        ![](./catapult-spider-adversary-quest-walkthrough-2022_files/patch-tuesday-blog-1.jpg)
        :::

        ::: {.d-flex .flex-column}
        ::: {.title}
        August 2022 Patch Tuesday: 17 Critical CVEs and Two Zero-Days,
        One Under Active Exploitation
        :::

        ::: {.date}
        Aug 11, 2022
        :::
        :::
-   [Videos](https://www.crowdstrike.com/blog/videos/){.blog_navigation_right_li_header}
    -   [](https://www.crowdstrike.com/blog/video-highlights-the-4-key-steps-to-successful-incident-response/)
        ::: {.image}
        ![](./catapult-spider-adversary-quest-walkthrough-2022_files/IR-Video-Blog-1.jpg)
        :::

        ::: {.d-flex .flex-column}
        ::: {.title}
        Video Highlights the 4 Key Steps to Successful Incident Response
        :::

        ::: {.date}
        Dec 02, 2019
        :::
        :::
    -   [](https://www.crowdstrike.com/blog/the-crowdstrike-vision-to-redefine-endpoint-security-video/)
        ::: {.image}
        ![](./catapult-spider-adversary-quest-walkthrough-2022_files/Vision-Video-Blog-Image-GK-1.jpg)
        :::

        ::: {.d-flex .flex-column}
        ::: {.title}
        Video: How CrowdStrike's Vision Redefined Endpoint Security
        :::

        ::: {.date}
        Sep 20, 2019
        :::
        :::
    -   [](https://www.crowdstrike.com/blog/mac-attack-credential-theft-video-rsa-2019/)
        ::: {.image}
        ![](./catapult-spider-adversary-quest-walkthrough-2022_files/Blog-Image-CredTheft-Demo-1.png)
        :::

        ::: {.d-flex .flex-column}
        ::: {.title}
        Mac Attacks Along the Kill Chain: Credential Theft \[VIDEO\]
        :::

        ::: {.date}
        Apr 19, 2019
        :::
        :::
    -   [](https://www.crowdstrike.com/blog/mac-attack-privilege-escalation-video-rsa-2019/)
        ::: {.image}
        ![](./catapult-spider-adversary-quest-walkthrough-2022_files/Blog-Image-Priv-Esca-Demo2-1.png)
        :::

        ::: {.d-flex .flex-column}
        ::: {.title}
        Mac Attacks Along the Kill Chain: Part 2 --- Privilege
        Escalation \[VIDEO\]
        :::

        ::: {.date}
        Apr 12, 2019
        :::
        :::
-   [Categories](https://www.crowdstrike.com/blog/categories-overview/){.blog_navigation_right_li_header}
    -   [](https://www.crowdstrike.com/blog/category/endpoint-protection/)
        ::: {.title}
        Endpoint & Cloud Security
        :::

        Endpoint & Cloud Security
        :   [](https://www.crowdstrike.com/blog/why-xdr-should-be-on-your-soc-roadmap/)
            ::: {.image}
            ![](./catapult-spider-adversary-quest-walkthrough-2022_files/0622_02_RSA-Day3_MikeS_Blog_1060x698.jpeg)
            :::

            ::: {.title}
            Why XDR Should Be on Your Roadmap for SOC Success
            :::

            ::: {.date}
            08/16/2022
            :::
        :   [](https://www.crowdstrike.com/blog/crowdstrike-wins-frost-and-sullivans-global-technology-innovation-leadership-award/)
            ::: {.image}
            ![](./catapult-spider-adversary-quest-walkthrough-2022_files/0722_08_Tech-Innovation-Leadership-Award_R2_Blog_1060x698.jpeg)
            :::

            ::: {.title}
            CrowdStrike Wins Technology Innovation Leadership Award,
            Continues Dominance in Endpoint Security Market
            :::

            ::: {.date}
            08/16/2022
            :::
        :   [](https://www.crowdstrike.com/blog/patch-tuesday-analysis-august-2022/)
            ::: {.image}
            ![](./catapult-spider-adversary-quest-walkthrough-2022_files/patch-tuesday-blog-1.jpg)
            :::

            ::: {.title}
            August 2022 Patch Tuesday: 17 Critical CVEs and Two
            Zero-Days, One Under Active Exploitation
            :::

            ::: {.date}
            08/11/2022
            :::
        :   [](https://www.crowdstrike.com/blog/crowdstrike-and-industry-partners-release-open-cybersecurity-schema-framework/)
            ::: {.image}
            ![](./catapult-spider-adversary-quest-walkthrough-2022_files/0722_09_OCSR_Blog_1060x698.jpeg)
            :::

            ::: {.title}
            CrowdStrike and Industry Partners Release Open Cybersecurity
            Schema Framework
            :::

            ::: {.date}
            08/10/2022
            :::
    -   [](https://www.crowdstrike.com/blog/category/engineering-and-technology/)
        ::: {.title}
        Engineering & Tech
        :::

        Engineering & Tech
        :   [](https://www.crowdstrike.com/blog/the-anatomy-of-wiper-malware-part-1/)
            ::: {.image}
            ![](./catapult-spider-adversary-quest-walkthrough-2022_files/Blog_1060x698-1.jpeg)
            :::

            ::: {.title}
            The Anatomy of Wiper Malware, Part 1: Common Techniques
            :::

            ::: {.date}
            08/12/2022
            :::
        :   [](https://www.crowdstrike.com/blog/improving-detection-content-with-gap-analysis-team/)
            ::: {.image}
            ![](./catapult-spider-adversary-quest-walkthrough-2022_files/Blog_1060x698.jpeg)
            :::

            ::: {.title}
            Improving CrowdStrike Falcon Detection Content with the Gap
            Analysis Team
            :::

            ::: {.date}
            08/08/2022
            :::
        :   [](https://www.crowdstrike.com/blog/deep-dive-into-custom-spark-transformers-for-machine-learning-pipelines/)
            ::: {.image}
            ![](./catapult-spider-adversary-quest-walkthrough-2022_files/Blog_1060x698-2.jpeg)
            :::

            ::: {.title}
            A Deep Dive into Custom Spark Transformers for Machine
            Learning Pipelines
            :::

            ::: {.date}
            07/27/2022
            :::
        :   [](https://www.crowdstrike.com/blog/how-crowdstrike-stops-modern-identity-based-attacks-in-chrome/)
            ::: {.image}
            ![](./catapult-spider-adversary-quest-walkthrough-2022_files/0522_09_CyberArk_Falcon-Coverage_Chrome_Blog_1060x698.jpeg)
            :::

            ::: {.title}
            CrowdStrike Falcon Stops Modern Identity-Based Attacks in
            Chrome
            :::

            ::: {.date}
            06/08/2022
            :::
    -   [](https://www.crowdstrike.com/blog/category/executive-viewpoint/)
        ::: {.title}
        Executive Viewpoint
        :::

        Executive Viewpoint
        :   [](https://www.crowdstrike.com/blog/experts-discuss-why-xdr-must-start-with-edr/)
            ::: {.image}
            ![](./catapult-spider-adversary-quest-walkthrough-2022_files/Blog_1060x698-3.jpeg)
            :::

            ::: {.title}
            Why XDR Must Start with EDR: Join the Discussion with
            CrowdStrike and Guest Forrester Research
            :::

            ::: {.date}
            08/03/2022
            :::
        :   [](https://www.crowdstrike.com/blog/adversary-universe-world-tour-coming-to-city-near-you/)
            ::: {.image}
            ![](./catapult-spider-adversary-quest-walkthrough-2022_files/0722_01_AU-World-Tour_Blog.jpeg)
            :::

            ::: {.title}
            CrowdStrike's Adversary Universe World Tour: Coming to a
            City Near You!
            :::

            ::: {.date}
            07/19/2022
            :::
        :   [](https://www.crowdstrike.com/blog/crowdstrike-delivers-protection-that-powers-productivity-rsac-2022/)
            ::: {.image}
            ![](./catapult-spider-adversary-quest-walkthrough-2022_files/0622_02_RSA-Day1_George_Blog_1060x698.jpeg)
            :::

            ::: {.title}
            RSAC 2022: CrowdStrike Delivers Protection that Powers
            Productivity
            :::

            ::: {.date}
            06/06/2022
            :::
        :   [](https://www.crowdstrike.com/blog/crowdstrike-announces-innovations-that-prioritize-data-rsac-2022/)
            ::: {.image}
            ![](./catapult-spider-adversary-quest-walkthrough-2022_files/0622_02_RSA-Day3_MikeS_Blog_1060x698(1).jpeg)
            :::

            ::: {.title}
            RSAC 2022: CrowdStrike Innovations that Prioritize Data
            :::

            ::: {.date}
            06/06/2022
            :::
    -   [](https://www.crowdstrike.com/blog/category/from-the-front-lines/)
        ::: {.title}
        From The Front Lines
        :::

        From The Front Lines
        :   [](https://www.crowdstrike.com/blog/overwatch-elite-in-action-tailored-threat-hunting-services/)
            ::: {.image}
            ![](./catapult-spider-adversary-quest-walkthrough-2022_files/Blog_1060x698-4.jpeg)
            :::

            ::: {.title}
            Falcon OverWatch Elite in Action: Tailored Threat Hunting
            Services Provide Individualized Care and Support
            :::

            ::: {.date}
            06/29/2022
            :::
        :   [](https://www.crowdstrike.com/blog/novel-exploit-detected-in-mitel-voip-appliance/)
            ::: {.image}
            ![](./catapult-spider-adversary-quest-walkthrough-2022_files/0622_06_Call_In-Side_House_Blog_1060x698.jpeg)
            :::

            ::: {.title}
            The Call Is Coming from Inside the House: CrowdStrike
            Identifies Novel Exploit in VOIP Appliance
            :::

            ::: {.date}
            06/23/2022
            :::
        :   [](https://www.crowdstrike.com/blog/7-key-ingredients-of-incident-response/)
            ::: {.image}
            ![](./catapult-spider-adversary-quest-walkthrough-2022_files/22-GC-027-IR-eBook_Social_Blog_7-Key-Ingredients.png)
            :::

            ::: {.title}
            Seven Key Ingredients of Incident Response to Reduce the
            Time and Cost of Recovery
            :::

            ::: {.date}
            06/08/2022
            :::
        :   [](https://www.crowdstrike.com/blog/how-overwatch-hunts-for-vulnerabilities-like-follina/)
            ::: {.image}
            ![](./catapult-spider-adversary-quest-walkthrough-2022_files/0221_05_BackDoor.jpeg)
            :::

            ::: {.title}
            OverWatch Casts a Wide Net for Follina: Hunting Beyond the
            Proof of Concept
            :::

            ::: {.date}
            06/02/2022
            :::
    -   [](https://www.crowdstrike.com/blog/category/identity-protection/)
        ::: {.title}
        Identity Protection
        :::

        Identity Protection
        :   [](https://www.crowdstrike.com/blog/how-to-detect-domain-controller-account-relay-attacks-with-crowdstrike-identity-protection/)
            ::: {.image}
            ![](./catapult-spider-adversary-quest-walkthrough-2022_files/Blog_1060x698-1(1).jpeg)
            :::

            ::: {.title}
            Detecting and Mitigating NTLM Relay Attacks Targeting
            Microsoft Domain Controllers
            :::

            ::: {.date}
            06/29/2022
            :::
        :   [](https://www.crowdstrike.com/blog/how-falcon-identity-threat-protection-helps-meet-identity-security-government-mandates/)
            ::: {.image}
            ![](./catapult-spider-adversary-quest-walkthrough-2022_files/0522_11_Falcon_ID-Threat-Protection_Fed-State-Local_Blog_1060x698.jpeg)
            :::

            ::: {.title}
            CrowdStrike Falcon Identity Threat Protection Added to
            GovCloud-1 to Help Meet Government Mandates for Identity
            Security and Zero Trust
            :::

            ::: {.date}
            06/01/2022
            :::
        :   [](https://www.crowdstrike.com/blog/crowdstrike-identity-protection-shuts-down-mitre-attack-adversaries/)
            ::: {.image}
            ![](./catapult-spider-adversary-quest-walkthrough-2022_files/0322_14_MITRE_ATTCK_02_Blog_1060x698.jpeg)
            :::

            ::: {.title}
            Falcon Platform Identity Protection Shuts Down MITRE ATT&CK
            Adversaries
            :::

            ::: {.date}
            04/07/2022
            :::
        :   [](https://www.crowdstrike.com/blog/why-you-shouldnt-buy-iam-and-identity-security-from-the-same-vendor/)
            ::: {.image}
            ![](./catapult-spider-adversary-quest-walkthrough-2022_files/Blog_1060x698-2(1).jpeg)
            :::

            ::: {.title}
            Buying IAM and Identity Security from the Same Vendor? Think
            Again.
            :::

            ::: {.date}
            03/10/2022
            :::
    -   [](https://www.crowdstrike.com/blog/category/observability-and-log-management/)
        ::: {.title}
        Observability & Log Management
        :::

        Observability & Log Management
        :   [](https://www.crowdstrike.com/blog/one-engineer-one-day-one-petabyte-of-log-data/)
            ::: {.image}
            ![](./catapult-spider-adversary-quest-walkthrough-2022_files/Screen-Shot-2022-05-12-at-9.05.09-AM.png)
            :::

            ::: {.title}
            One engineer. One day. One petabyte of log data.
            :::

            ::: {.date}
            05/12/2022
            :::
        :   [](https://www.crowdstrike.com/blog/humio-sets-the-standard-for-data-ingestion-with-scalability-benchmark-streaming-over-one-petabyte-of-data-per-day/)
            ::: {.image}
            ![](./catapult-spider-adversary-quest-walkthrough-2022_files/Screen-Shot-2022-05-10-at-8.07.59-AM.png)
            :::

            ::: {.title}
            Humio Sets the Standard for Data Ingestion with Scalability
            Benchmark Streaming over One Petabyte of Data per Day
            :::

            ::: {.date}
            05/10/2022
            :::
        :   [](https://www.crowdstrike.com/blog/start-logging-everything-humio-community-edition-series/)
            ::: {.image}
            ![](./catapult-spider-adversary-quest-walkthrough-2022_files/Screen-Shot-2022-05-05-at-7.35.28-AM.png)
            :::

            ::: {.title}
            Start Logging Everything: Humio Community Edition Series
            :::

            ::: {.date}
            05/05/2022
            :::
        :   [](https://www.crowdstrike.com/blog/what-is-data-logging/)
            ::: {.image}
            ![](./catapult-spider-adversary-quest-walkthrough-2022_files/Screen-Shot-2021-05-13-at-1.30.38-PM-1.jpg)
            :::

            ::: {.title}
            What Is Data Logging?
            :::

            ::: {.date}
            12/21/2021
            :::
    -   [](https://www.crowdstrike.com/blog/category/people-culture/)
        ::: {.title}
        People & Culture
        :::

        People & Culture
        :   [](https://www.crowdstrike.com/blog/shaping-the-next-generation-of-cybersecurity-professionals/)
            ::: {.image}
            ![](./catapult-spider-adversary-quest-walkthrough-2022_files/0722_06_Interns_Blog_1060x698.jpeg)
            :::

            ::: {.title}
            CrowdStrike University Recruiting Program: Shaping the Next
            Generation of Cybersecurity Professionals
            :::

            ::: {.date}
            08/03/2022
            :::
        :   [](https://www.crowdstrike.com/blog/five-questions-with-denise-stemen/)
            ::: {.image}
            ![](./catapult-spider-adversary-quest-walkthrough-2022_files/Blog_FB_1200x630-1.jpg)
            :::

            ::: {.title}
            Denise Stemen, CrowdStrike Director of Customer Crisis
            Strategy and Response, on Bringing Inclusivity to Life
            :::

            ::: {.date}
            05/13/2022
            :::
        :   [](https://www.crowdstrike.com/blog/five-questions-with-lowell-doringo/)
            ::: {.image}
            ![](./catapult-spider-adversary-quest-walkthrough-2022_files/Blog_FB_1200x630-1.jpg)
            :::

            ::: {.title}
            How Senior Manager for Learning and Talent Lowell Doringo
            Helps CrowdStrikers Excel
            :::

            ::: {.date}
            05/05/2022
            :::
        :   [](https://www.crowdstrike.com/blog/five-questions-with-cinthia-portugal/)
            ::: {.image}
            ![](./catapult-spider-adversary-quest-walkthrough-2022_files/Blog_FB_1200x630-1.jpg)
            :::

            ::: {.title}
            VP of Humio Marketing Cinthia Portugal on the Role of
            Marketing in Achieving the CrowdStrike Mission
            :::

            ::: {.date}
            05/03/2022
            :::
    -   [](https://www.crowdstrike.com/blog/category/remote-workplace/)
        ::: {.title}
        Remote Workplace
        :::

        Remote Workplace
        :   [](https://www.crowdstrike.com/blog/crowdstrike-changes-principal-executive-office-to-austin-texas/)
            ::: {.image}
            ![](./catapult-spider-adversary-quest-walkthrough-2022_files/Blog-1.jpeg)
            :::

            ::: {.title}
            CrowdStrike Changes Designation of Principal Executive
            Office to Austin, Texas
            :::

            ::: {.date}
            12/28/2021
            :::
        :   [](https://www.crowdstrike.com/blog/crowdstrike-and-ey-join-forces/)
            ::: {.image}
            ![](./catapult-spider-adversary-quest-walkthrough-2022_files/CS_EY_Blog_1060x698_v2-1.jpeg)
            :::

            ::: {.title}
            CrowdStrike and EY Join Forces to Boost Organizational
            Resiliency
            :::

            ::: {.date}
            05/24/2021
            :::
        :   [](https://www.crowdstrike.com/blog/zero-trust-security-with-crowdstrike-and-zscaler/)
            ::: {.image}
            ![](./catapult-spider-adversary-quest-walkthrough-2022_files/Go-Beyond-the-Perimeter-1.jpg)
            :::

            ::: {.title}
            Go Beyond the Perimeter: Frictionless Zero Trust With
            CrowdStrike and Zscaler
            :::

            ::: {.date}
            03/29/2021
            :::
        :   [](https://www.crowdstrike.com/blog/policy-management-remote-systems/)
            ::: {.image}
            ![](./catapult-spider-adversary-quest-walkthrough-2022_files/TechCenter-2.jpg)
            :::

            ::: {.title}
            Flexible Policy Management for Remote Systems
            :::

            ::: {.date}
            07/08/2020
            :::
    -   [](https://www.crowdstrike.com/blog/category/threat-intel-research/)
        ::: {.title}
        Research & Threat Intel
        :::

        Research & Threat Intel
        :   [](https://www.crowdstrike.com/blog/tabloid-jackal-adversary-quest-walkthrough-2022/)
            ::: {.image}
            ![](./catapult-spider-adversary-quest-walkthrough-2022_files/0722_03_AdversaryQuest_2022_Hacktivist_TABLOID-JACKAL_Blog_1060x698.jpeg)
            :::

            ::: {.title}
            Adversary Quest 2022 Walkthrough, Part 2: Four TABLOID
            JACKAL Challenges
            :::

            ::: {.date}
            08/09/2022
            :::
        :   [](https://www.crowdstrike.com/blog/catapult-spider-adversary-quest-walkthrough-2022/)
            ::: {.image}
            ![](./catapult-spider-adversary-quest-walkthrough-2022_files/AdversaryQuest-1-featured-image.png)
            :::

            ::: {.title}
            Adversary Quest 2022 Walkthrough, Part 1: Four CATAPULT
            SPIDER Challenges
            :::

            ::: {.date}
            08/03/2022
            :::
        :   [](https://www.crowdstrike.com/blog/callback-malware-campaigns-impersonate-crowdstrike-and-other-cybersecurity-companies/)
            ::: {.image}
            ![](./catapult-spider-adversary-quest-walkthrough-2022_files/0622_03_Gartner-Security-Risk-Management-Summit_Blog.jpeg)
            :::

            ::: {.title}
            Callback Malware Campaigns Impersonate CrowdStrike and Other
            Cybersecurity Companies
            :::

            ::: {.date}
            07/08/2022
            :::
        :   [](https://www.crowdstrike.com/blog/how-crowdstrike-traces-the-evolution-of-ecrime/)
            ::: {.image}
            ![](./catapult-spider-adversary-quest-walkthrough-2022_files/Falcon-X-Recon-featured-image-1.jpeg)
            :::

            ::: {.title}
            Tales from the Dark Web: How Tracking eCrime's Underground
            Economy Improves Defenses
            :::

            ::: {.date}
            06/30/2022
            :::
    -   [](https://www.crowdstrike.com/blog/tech-center/)
        ::: {.title}
        Tech Center
        :::

        Tech Center
        :   [](https://www.crowdstrike.com/blog/tech-center/log-management-observability/)
            ::: {.image}
            ![](./catapult-spider-adversary-quest-walkthrough-2022_files/TechCenter-2.jpg)
            :::

            ::: {.title}
            Log Management and Observability
            :::

            ::: {.date}
            08/03/2022
            :::
        :   [](https://www.crowdstrike.com/blog/tech-center/custom-cloud-policies/)
            ::: {.image}
            ![](./catapult-spider-adversary-quest-walkthrough-2022_files/TechCenter-2.jpg)
            :::

            ::: {.title}
            How to Create Custom Cloud Security Posture Policies
            :::

            ::: {.date}
            04/07/2022
            :::
        :   [](https://www.crowdstrike.com/blog/tech-center/falcon-fusion-and-real-time-response/)
            ::: {.image}
            ![](./catapult-spider-adversary-quest-walkthrough-2022_files/TechCenter-2.jpg)
            :::

            ::: {.title}
            How to automate workflows with Falcon Fusion and Real Time
            Response
            :::

            ::: {.date}
            03/25/2022
            :::
        :   [](https://www.crowdstrike.com/blog/tech-center/automate-workflows-spotlight/)
            ::: {.image}
            ![](./catapult-spider-adversary-quest-walkthrough-2022_files/TechCenter-2.jpg)
            :::

            ::: {.title}
            How to Automate Workflows with Falcon Spotlight
            :::

            ::: {.date}
            02/18/2022
            :::
-   [Start Free
    Trial](https://go.crowdstrike.com/try-falcon-prevent.html){.blog_navigation_right_li_header}
    -   [](https://www.crowdstrike.com/blog/category/endpoint-protection/)
        ::: {.title}
        Endpoint & Cloud Security
        :::

        Endpoint & Cloud Security
        :   [](https://www.crowdstrike.com/blog/why-xdr-should-be-on-your-soc-roadmap/)
            ::: {.image}
            ![](./catapult-spider-adversary-quest-walkthrough-2022_files/0622_02_RSA-Day3_MikeS_Blog_1060x698.jpeg)
            :::

            ::: {.title}
            Why XDR Should Be on Your Roadmap for SOC Success
            :::

            ::: {.date}
            08/16/2022
            :::
        :   [](https://www.crowdstrike.com/blog/crowdstrike-wins-frost-and-sullivans-global-technology-innovation-leadership-award/)
            ::: {.image}
            ![](./catapult-spider-adversary-quest-walkthrough-2022_files/0722_08_Tech-Innovation-Leadership-Award_R2_Blog_1060x698.jpeg)
            :::

            ::: {.title}
            CrowdStrike Wins Technology Innovation Leadership Award,
            Continues Dominance in Endpoint Security Market
            :::

            ::: {.date}
            08/16/2022
            :::
        :   [](https://www.crowdstrike.com/blog/patch-tuesday-analysis-august-2022/)
            ::: {.image}
            ![](./catapult-spider-adversary-quest-walkthrough-2022_files/patch-tuesday-blog-1.jpg)
            :::

            ::: {.title}
            August 2022 Patch Tuesday: 17 Critical CVEs and Two
            Zero-Days, One Under Active Exploitation
            :::

            ::: {.date}
            08/11/2022
            :::
        :   [](https://www.crowdstrike.com/blog/crowdstrike-and-industry-partners-release-open-cybersecurity-schema-framework/)
            ::: {.image}
            ![](./catapult-spider-adversary-quest-walkthrough-2022_files/0722_09_OCSR_Blog_1060x698.jpeg)
            :::

            ::: {.title}
            CrowdStrike and Industry Partners Release Open Cybersecurity
            Schema Framework
            :::

            ::: {.date}
            08/10/2022
            :::
    -   [](https://www.crowdstrike.com/blog/category/engineering-and-technology/)
        ::: {.title}
        Engineering & Tech
        :::

        Engineering & Tech
        :   [](https://www.crowdstrike.com/blog/the-anatomy-of-wiper-malware-part-1/)
            ::: {.image}
            ![](./catapult-spider-adversary-quest-walkthrough-2022_files/Blog_1060x698-1.jpeg)
            :::

            ::: {.title}
            The Anatomy of Wiper Malware, Part 1: Common Techniques
            :::

            ::: {.date}
            08/12/2022
            :::
        :   [](https://www.crowdstrike.com/blog/improving-detection-content-with-gap-analysis-team/)
            ::: {.image}
            ![](./catapult-spider-adversary-quest-walkthrough-2022_files/Blog_1060x698.jpeg)
            :::

            ::: {.title}
            Improving CrowdStrike Falcon Detection Content with the Gap
            Analysis Team
            :::

            ::: {.date}
            08/08/2022
            :::
        :   [](https://www.crowdstrike.com/blog/deep-dive-into-custom-spark-transformers-for-machine-learning-pipelines/)
            ::: {.image}
            ![](./catapult-spider-adversary-quest-walkthrough-2022_files/Blog_1060x698-2.jpeg)
            :::

            ::: {.title}
            A Deep Dive into Custom Spark Transformers for Machine
            Learning Pipelines
            :::

            ::: {.date}
            07/27/2022
            :::
        :   [](https://www.crowdstrike.com/blog/how-crowdstrike-stops-modern-identity-based-attacks-in-chrome/)
            ::: {.image}
            ![](./catapult-spider-adversary-quest-walkthrough-2022_files/0522_09_CyberArk_Falcon-Coverage_Chrome_Blog_1060x698.jpeg)
            :::

            ::: {.title}
            CrowdStrike Falcon Stops Modern Identity-Based Attacks in
            Chrome
            :::

            ::: {.date}
            06/08/2022
            :::
    -   [](https://www.crowdstrike.com/blog/category/executive-viewpoint/)
        ::: {.title}
        Executive Viewpoint
        :::

        Executive Viewpoint
        :   [](https://www.crowdstrike.com/blog/experts-discuss-why-xdr-must-start-with-edr/)
            ::: {.image}
            ![](./catapult-spider-adversary-quest-walkthrough-2022_files/Blog_1060x698-3.jpeg)
            :::

            ::: {.title}
            Why XDR Must Start with EDR: Join the Discussion with
            CrowdStrike and Guest Forrester Research
            :::

            ::: {.date}
            08/03/2022
            :::
        :   [](https://www.crowdstrike.com/blog/adversary-universe-world-tour-coming-to-city-near-you/)
            ::: {.image}
            ![](./catapult-spider-adversary-quest-walkthrough-2022_files/0722_01_AU-World-Tour_Blog.jpeg)
            :::

            ::: {.title}
            CrowdStrike's Adversary Universe World Tour: Coming to a
            City Near You!
            :::

            ::: {.date}
            07/19/2022
            :::
        :   [](https://www.crowdstrike.com/blog/crowdstrike-delivers-protection-that-powers-productivity-rsac-2022/)
            ::: {.image}
            ![](./catapult-spider-adversary-quest-walkthrough-2022_files/0622_02_RSA-Day1_George_Blog_1060x698.jpeg)
            :::

            ::: {.title}
            RSAC 2022: CrowdStrike Delivers Protection that Powers
            Productivity
            :::

            ::: {.date}
            06/06/2022
            :::
        :   [](https://www.crowdstrike.com/blog/crowdstrike-announces-innovations-that-prioritize-data-rsac-2022/)
            ::: {.image}
            ![](./catapult-spider-adversary-quest-walkthrough-2022_files/0622_02_RSA-Day3_MikeS_Blog_1060x698(1).jpeg)
            :::

            ::: {.title}
            RSAC 2022: CrowdStrike Innovations that Prioritize Data
            :::

            ::: {.date}
            06/06/2022
            :::
    -   [](https://www.crowdstrike.com/blog/category/from-the-front-lines/)
        ::: {.title}
        From The Front Lines
        :::

        From The Front Lines
        :   [](https://www.crowdstrike.com/blog/overwatch-elite-in-action-tailored-threat-hunting-services/)
            ::: {.image}
            ![](./catapult-spider-adversary-quest-walkthrough-2022_files/Blog_1060x698-4.jpeg)
            :::

            ::: {.title}
            Falcon OverWatch Elite in Action: Tailored Threat Hunting
            Services Provide Individualized Care and Support
            :::

            ::: {.date}
            06/29/2022
            :::
        :   [](https://www.crowdstrike.com/blog/novel-exploit-detected-in-mitel-voip-appliance/)
            ::: {.image}
            ![](./catapult-spider-adversary-quest-walkthrough-2022_files/0622_06_Call_In-Side_House_Blog_1060x698.jpeg)
            :::

            ::: {.title}
            The Call Is Coming from Inside the House: CrowdStrike
            Identifies Novel Exploit in VOIP Appliance
            :::

            ::: {.date}
            06/23/2022
            :::
        :   [](https://www.crowdstrike.com/blog/7-key-ingredients-of-incident-response/)
            ::: {.image}
            ![](./catapult-spider-adversary-quest-walkthrough-2022_files/22-GC-027-IR-eBook_Social_Blog_7-Key-Ingredients.png)
            :::

            ::: {.title}
            Seven Key Ingredients of Incident Response to Reduce the
            Time and Cost of Recovery
            :::

            ::: {.date}
            06/08/2022
            :::
        :   [](https://www.crowdstrike.com/blog/how-overwatch-hunts-for-vulnerabilities-like-follina/)
            ::: {.image}
            ![](./catapult-spider-adversary-quest-walkthrough-2022_files/0221_05_BackDoor.jpeg)
            :::

            ::: {.title}
            OverWatch Casts a Wide Net for Follina: Hunting Beyond the
            Proof of Concept
            :::

            ::: {.date}
            06/02/2022
            :::
    -   [](https://www.crowdstrike.com/blog/category/identity-protection/)
        ::: {.title}
        Identity Protection
        :::

        Identity Protection
        :   [](https://www.crowdstrike.com/blog/how-to-detect-domain-controller-account-relay-attacks-with-crowdstrike-identity-protection/)
            ::: {.image}
            ![](./catapult-spider-adversary-quest-walkthrough-2022_files/Blog_1060x698-1(1).jpeg)
            :::

            ::: {.title}
            Detecting and Mitigating NTLM Relay Attacks Targeting
            Microsoft Domain Controllers
            :::

            ::: {.date}
            06/29/2022
            :::
        :   [](https://www.crowdstrike.com/blog/how-falcon-identity-threat-protection-helps-meet-identity-security-government-mandates/)
            ::: {.image}
            ![](./catapult-spider-adversary-quest-walkthrough-2022_files/0522_11_Falcon_ID-Threat-Protection_Fed-State-Local_Blog_1060x698.jpeg)
            :::

            ::: {.title}
            CrowdStrike Falcon Identity Threat Protection Added to
            GovCloud-1 to Help Meet Government Mandates for Identity
            Security and Zero Trust
            :::

            ::: {.date}
            06/01/2022
            :::
        :   [](https://www.crowdstrike.com/blog/crowdstrike-identity-protection-shuts-down-mitre-attack-adversaries/)
            ::: {.image}
            ![](./catapult-spider-adversary-quest-walkthrough-2022_files/0322_14_MITRE_ATTCK_02_Blog_1060x698.jpeg)
            :::

            ::: {.title}
            Falcon Platform Identity Protection Shuts Down MITRE ATT&CK
            Adversaries
            :::

            ::: {.date}
            04/07/2022
            :::
        :   [](https://www.crowdstrike.com/blog/why-you-shouldnt-buy-iam-and-identity-security-from-the-same-vendor/)
            ::: {.image}
            ![](./catapult-spider-adversary-quest-walkthrough-2022_files/Blog_1060x698-2(1).jpeg)
            :::

            ::: {.title}
            Buying IAM and Identity Security from the Same Vendor? Think
            Again.
            :::

            ::: {.date}
            03/10/2022
            :::
    -   [](https://www.crowdstrike.com/blog/category/observability-and-log-management/)
        ::: {.title}
        Observability & Log Management
        :::

        Observability & Log Management
        :   [](https://www.crowdstrike.com/blog/one-engineer-one-day-one-petabyte-of-log-data/)
            ::: {.image}
            ![](./catapult-spider-adversary-quest-walkthrough-2022_files/Screen-Shot-2022-05-12-at-9.05.09-AM.png)
            :::

            ::: {.title}
            One engineer. One day. One petabyte of log data.
            :::

            ::: {.date}
            05/12/2022
            :::
        :   [](https://www.crowdstrike.com/blog/humio-sets-the-standard-for-data-ingestion-with-scalability-benchmark-streaming-over-one-petabyte-of-data-per-day/)
            ::: {.image}
            ![](./catapult-spider-adversary-quest-walkthrough-2022_files/Screen-Shot-2022-05-10-at-8.07.59-AM.png)
            :::

            ::: {.title}
            Humio Sets the Standard for Data Ingestion with Scalability
            Benchmark Streaming over One Petabyte of Data per Day
            :::

            ::: {.date}
            05/10/2022
            :::
        :   [](https://www.crowdstrike.com/blog/start-logging-everything-humio-community-edition-series/)
            ::: {.image}
            ![](./catapult-spider-adversary-quest-walkthrough-2022_files/Screen-Shot-2022-05-05-at-7.35.28-AM.png)
            :::

            ::: {.title}
            Start Logging Everything: Humio Community Edition Series
            :::

            ::: {.date}
            05/05/2022
            :::
        :   [](https://www.crowdstrike.com/blog/what-is-data-logging/)
            ::: {.image}
            ![](./catapult-spider-adversary-quest-walkthrough-2022_files/Screen-Shot-2021-05-13-at-1.30.38-PM-1.jpg)
            :::

            ::: {.title}
            What Is Data Logging?
            :::

            ::: {.date}
            12/21/2021
            :::
    -   [](https://www.crowdstrike.com/blog/category/people-culture/)
        ::: {.title}
        People & Culture
        :::

        People & Culture
        :   [](https://www.crowdstrike.com/blog/shaping-the-next-generation-of-cybersecurity-professionals/)
            ::: {.image}
            ![](./catapult-spider-adversary-quest-walkthrough-2022_files/0722_06_Interns_Blog_1060x698.jpeg)
            :::

            ::: {.title}
            CrowdStrike University Recruiting Program: Shaping the Next
            Generation of Cybersecurity Professionals
            :::

            ::: {.date}
            08/03/2022
            :::
        :   [](https://www.crowdstrike.com/blog/five-questions-with-denise-stemen/)
            ::: {.image}
            ![](./catapult-spider-adversary-quest-walkthrough-2022_files/Blog_FB_1200x630-1.jpg)
            :::

            ::: {.title}
            Denise Stemen, CrowdStrike Director of Customer Crisis
            Strategy and Response, on Bringing Inclusivity to Life
            :::

            ::: {.date}
            05/13/2022
            :::
        :   [](https://www.crowdstrike.com/blog/five-questions-with-lowell-doringo/)
            ::: {.image}
            ![](./catapult-spider-adversary-quest-walkthrough-2022_files/Blog_FB_1200x630-1.jpg)
            :::

            ::: {.title}
            How Senior Manager for Learning and Talent Lowell Doringo
            Helps CrowdStrikers Excel
            :::

            ::: {.date}
            05/05/2022
            :::
        :   [](https://www.crowdstrike.com/blog/five-questions-with-cinthia-portugal/)
            ::: {.image}
            ![](./catapult-spider-adversary-quest-walkthrough-2022_files/Blog_FB_1200x630-1.jpg)
            :::

            ::: {.title}
            VP of Humio Marketing Cinthia Portugal on the Role of
            Marketing in Achieving the CrowdStrike Mission
            :::

            ::: {.date}
            05/03/2022
            :::
    -   [](https://www.crowdstrike.com/blog/category/remote-workplace/)
        ::: {.title}
        Remote Workplace
        :::

        Remote Workplace
        :   [](https://www.crowdstrike.com/blog/crowdstrike-changes-principal-executive-office-to-austin-texas/)
            ::: {.image}
            ![](./catapult-spider-adversary-quest-walkthrough-2022_files/Blog-1.jpeg)
            :::

            ::: {.title}
            CrowdStrike Changes Designation of Principal Executive
            Office to Austin, Texas
            :::

            ::: {.date}
            12/28/2021
            :::
        :   [](https://www.crowdstrike.com/blog/crowdstrike-and-ey-join-forces/)
            ::: {.image}
            ![](./catapult-spider-adversary-quest-walkthrough-2022_files/CS_EY_Blog_1060x698_v2-1.jpeg)
            :::

            ::: {.title}
            CrowdStrike and EY Join Forces to Boost Organizational
            Resiliency
            :::

            ::: {.date}
            05/24/2021
            :::
        :   [](https://www.crowdstrike.com/blog/zero-trust-security-with-crowdstrike-and-zscaler/)
            ::: {.image}
            ![](./catapult-spider-adversary-quest-walkthrough-2022_files/Go-Beyond-the-Perimeter-1.jpg)
            :::

            ::: {.title}
            Go Beyond the Perimeter: Frictionless Zero Trust With
            CrowdStrike and Zscaler
            :::

            ::: {.date}
            03/29/2021
            :::
        :   [](https://www.crowdstrike.com/blog/policy-management-remote-systems/)
            ::: {.image}
            ![](./catapult-spider-adversary-quest-walkthrough-2022_files/TechCenter-2.jpg)
            :::

            ::: {.title}
            Flexible Policy Management for Remote Systems
            :::

            ::: {.date}
            07/08/2020
            :::
    -   [](https://www.crowdstrike.com/blog/category/threat-intel-research/)
        ::: {.title}
        Research & Threat Intel
        :::

        Research & Threat Intel
        :   [](https://www.crowdstrike.com/blog/tabloid-jackal-adversary-quest-walkthrough-2022/)
            ::: {.image}
            ![](./catapult-spider-adversary-quest-walkthrough-2022_files/0722_03_AdversaryQuest_2022_Hacktivist_TABLOID-JACKAL_Blog_1060x698.jpeg)
            :::

            ::: {.title}
            Adversary Quest 2022 Walkthrough, Part 2: Four TABLOID
            JACKAL Challenges
            :::

            ::: {.date}
            08/09/2022
            :::
        :   [](https://www.crowdstrike.com/blog/catapult-spider-adversary-quest-walkthrough-2022/)
            ::: {.image}
            ![](./catapult-spider-adversary-quest-walkthrough-2022_files/AdversaryQuest-1-featured-image.png)
            :::

            ::: {.title}
            Adversary Quest 2022 Walkthrough, Part 1: Four CATAPULT
            SPIDER Challenges
            :::

            ::: {.date}
            08/03/2022
            :::
        :   [](https://www.crowdstrike.com/blog/callback-malware-campaigns-impersonate-crowdstrike-and-other-cybersecurity-companies/)
            ::: {.image}
            ![](./catapult-spider-adversary-quest-walkthrough-2022_files/0622_03_Gartner-Security-Risk-Management-Summit_Blog.jpeg)
            :::

            ::: {.title}
            Callback Malware Campaigns Impersonate CrowdStrike and Other
            Cybersecurity Companies
            :::

            ::: {.date}
            07/08/2022
            :::
        :   [](https://www.crowdstrike.com/blog/how-crowdstrike-traces-the-evolution-of-ecrime/)
            ::: {.image}
            ![](./catapult-spider-adversary-quest-walkthrough-2022_files/Falcon-X-Recon-featured-image-1.jpeg)
            :::

            ::: {.title}
            Tales from the Dark Web: How Tracking eCrime's Underground
            Economy Improves Defenses
            :::

            ::: {.date}
            06/30/2022
            :::
    -   [](https://www.crowdstrike.com/blog/tech-center/)
        ::: {.title}
        Tech Center
        :::

        Tech Center
        :   [](https://www.crowdstrike.com/blog/tech-center/log-management-observability/)
            ::: {.image}
            ![](./catapult-spider-adversary-quest-walkthrough-2022_files/TechCenter-2.jpg)
            :::

            ::: {.title}
            Log Management and Observability
            :::

            ::: {.date}
            08/03/2022
            :::
        :   [](https://www.crowdstrike.com/blog/tech-center/custom-cloud-policies/)
            ::: {.image}
            ![](./catapult-spider-adversary-quest-walkthrough-2022_files/TechCenter-2.jpg)
            :::

            ::: {.title}
            How to Create Custom Cloud Security Posture Policies
            :::

            ::: {.date}
            04/07/2022
            :::
        :   [](https://www.crowdstrike.com/blog/tech-center/falcon-fusion-and-real-time-response/)
            ::: {.image}
            ![](./catapult-spider-adversary-quest-walkthrough-2022_files/TechCenter-2.jpg)
            :::

            ::: {.title}
            How to automate workflows with Falcon Fusion and Real Time
            Response
            :::

            ::: {.date}
            03/25/2022
            :::
        :   [](https://www.crowdstrike.com/blog/tech-center/automate-workflows-spotlight/)
            ::: {.image}
            ![](./catapult-spider-adversary-quest-walkthrough-2022_files/TechCenter-2.jpg)
            :::

            ::: {.title}
            How to Automate Workflows with Falcon Spotlight
            :::

            ::: {.date}
            02/18/2022
            :::

::: {#blogMobileMenuBtn .mobile_menu_btn .red}
:::
:::
:::
:::
:::

::: {.blog_navigation_mobile}
::: {.container}
::: {.row}
::: {.col-12}
-   [Featured](https://www.crowdstrike.com/blog/featured-articles/)
-   [Recent](https://www.crowdstrike.com/blog/recent-articles/)
-   [Videos](https://www.crowdstrike.com/blog/videos/)
-   [Categories](https://www.crowdstrike.com/blog/categories-overview/)
-   [Start Free
    Trial](https://go.crowdstrike.com/try-falcon-prevent.html)
:::
:::
:::
:::
:::
:::

::: {.cs_page_container .promobar_active}
::: {.search_modal}
::: {.cs_header_container .search_modal__section .centered}
:::
:::

::: {#headerPromobar}
::: {.promobar style="background: url(/wp-content/uploads/2022/06/black-promo-bar.jpeg) no-repeat center top/cover"}
::: {.container}
::: {.row}
::: {.col-lg-12 .main-content .p-0}
::: {#handlePromoClose .promobar_close}
:::

::: {.content_container .w-100 .d-flex .align-items-center .justify-content-center}
[](https://www.crowdstrike.com/events/fal-con/){.promolink}

::: {.list_wrapper .w-100 .d-flex}
-   100+ sessions. 8 tracks. 3 days. 1 incredible opportunity.

[Register for Fal.Con
2022](https://www.crowdstrike.com/events/fal-con/){.button
.red-background .white-text .dark-red-background-hover}
:::
:::
:::
:::
:::
:::
:::

::: {.cs_header_container .centered}
::: {#megamenu_top_insert .menu_inner_section}
:::
:::

::: {.mega_menu}
::: {.cs_header_container .centered .mega_menu__header}
::: {.header_logo}
:::

::: {#megaSearch .search_btn .fa-solid .fa-magnifying-glass data-id="search"}
:::

::: {#csMobileMenuBtn .mobile_menu_btn}
:::

::: {.mega_menu__content}

::: {#megamenu_bottom_nav_content .mega_menu__body}
:::
:::
:::
:::

::: {.cs_page_content}
::: {.mobile_nav_section}
::: {.mobile_nav_content}
::: {#megamenu_mobile_main_nav .list_items_content}
:::
:::
:::

::: {.cs_main_section}
::: {.main role="main"}
::: {.container}
::: {.row}
::: {.col-12 .col-lg-8}
Adversary Quest 2022 Walkthrough, Part 1: Four CATAPULT SPIDER Challenges
=========================================================================

::: {.publish_info}
August 3, 2022

[Benjamin Grap - Karsten Koenig - Lutz
Wolf](https://www.crowdstrike.com/blog/author/benjamin-grap-karsten-koenig-lutz-wolf/ "Posts by Benjamin Grap - Karsten Koenig - Lutz Wolf")
[Research & Threat
Intel](https://www.crowdstrike.com/blog/category/threat-intel-research/ "Research & Threat Intel")
:::

::: {.post_image}
![](./catapult-spider-adversary-quest-walkthrough-2022_files/AdversaryQuest-1-featured-image.png){.attachment-post-thumbnail
.size-post-thumbnail .wp-post-image width="1441" height="949"
sizes="(max-width: 1441px) 100vw, 1441px"
srcset="https://www.crowdstrike.com/wp-content/uploads/2022/08/AdversaryQuest-1-featured-image.png 1441w, https://www.crowdstrike.com/wp-content/uploads/2022/08/AdversaryQuest-1-featured-image-300x198.png 300w, https://www.crowdstrike.com/wp-content/uploads/2022/08/AdversaryQuest-1-featured-image-1024x674.png 1024w, https://www.crowdstrike.com/wp-content/uploads/2022/08/AdversaryQuest-1-featured-image-768x506.png 768w"}
:::

::: {.blog_content}
[In July 2022, the CrowdStrike Intelligence Advanced Research Team
hosted the second edition of our Adversary Quest. As in the previous
year, this "capture the flag" event featured 12 information security
challenges in three different tracks: eCrime, Hacktivism and Targeted
Intrusion. In each track, four consecutive challenges awaited the
players, requiring different skills including reverse engineering,
vulnerability analysis and exploitation, and
cryptanalysis.]{style="font-weight: 400;"}

[This blog post, the first in a series, describes our intended approach
to solving the challenges of the eCrime track. In this track, the
players were asked to analyze new activity by CATAPULT SPIDER, an
adversary that has returned since making an appearance in last year's
Adversary Quest. (Read [Part
2](https://www.crowdstrike.com/blog/tabloid-jackal-adversary-quest-walkthrough-2022/).)]{style="font-weight: 400;"}

[The objective of CATAPULT SPIDER was described as
follows:]{style="font-weight: 400;"}

*[After last year's campaign didn't go so well for the actor, they
improved their tools and mechanisms and are now launching a new
ransomware campaign. Their motivation is still to generate as much
dogecoin as possible.]{style="font-weight: 400;"}*

**Challenge \#1: Very Phish**
-----------------------------

[The first challenge of the CATAPULT SPIDER track is introduced as
follows:]{style="font-weight: 400;"}

*[CATAPULT SPIDER is running a new malware campaign. Still primarily
motivated by their greed for more Dogecoin, they are now distributing a
new malware loader via email. We were approached by a company that had
the misfortune of having their data encrypted. Without proper EDR they
were only able to identify a suspicious file that was sent to one of
their employees via email. We are not sure what this file is or how it
managed to infect the host, but it most likely is some type of loader
that downloads further components from their command-and-control (C2)
server. Sadly the C2 server has since been taken offline. However, we
were able to find another C2 server at 116.202.161.100. This server is
active, but we will need your expertise to find additional samples. Can
you help us identify the trick the loader used and track down further
samples that were downloaded by the loader?]{style="font-weight: 400;"}*

[We are provided with the sample file:
]{style="font-weight: 400;"}`9e32ac74b80976ca8f5386012bae9676decb23713443e81cb10f4456bf0e7e0b`

[To figure out what this file does and how it was able to infect a host,
we must first identify the file type. For this, we can use the command
line program
]{style="font-weight: 400;"}[`file`,]{style="font-weight: 400;"} [which
can identify most commonly used file types:]{style="font-weight: 400;"}

![](./catapult-spider-adversary-quest-walkthrough-2022_files/Picture1-3-1024x66.png){.alignnone
.wp-image-128520 .size-large width="1024" height="66"
sizes="(max-width: 1024px) 100vw, 1024px"
srcset="https://www.crowdstrike.com/wp-content/uploads/2022/08/Picture1-3-1024x66.png 1024w, https://www.crowdstrike.com/wp-content/uploads/2022/08/Picture1-3-300x19.png 300w, https://www.crowdstrike.com/wp-content/uploads/2022/08/Picture1-3-768x49.png 768w, https://www.crowdstrike.com/wp-content/uploads/2022/08/Picture1-3-1536x98.png 1536w, https://www.crowdstrike.com/wp-content/uploads/2022/08/Picture1-3-2048x131.png 2048w"}

[The file format is a Windows HtmlHelp Data file, i.e., a CHM file. This
document type is commonly used to provide help or general documentation
for Windows programs and is sometimes used as a format to distribute
ebooks. There are many programs that can be used to view the contents of
the file and a number of document viewers exist. By default, the file
type is opened using the Microsoft HTML Help executable
(]{style="font-weight: 400;"}`hh.exe`[) on Windows. Fortunately, the
7zip packer also supports this document format and allows us to list and
extract individual files:]{style="font-weight: 400;"}

![](./catapult-spider-adversary-quest-walkthrough-2022_files/Picture1-4.png){.alignnone
.size-full .wp-image-128521 width="1527" height="1233"
sizes="(max-width: 1527px) 100vw, 1527px"
srcset="https://www.crowdstrike.com/wp-content/uploads/2022/08/Picture1-4.png 1527w, https://www.crowdstrike.com/wp-content/uploads/2022/08/Picture1-4-300x242.png 300w, https://www.crowdstrike.com/wp-content/uploads/2022/08/Picture1-4-1024x827.png 1024w, https://www.crowdstrike.com/wp-content/uploads/2022/08/Picture1-4-768x620.png 768w"}

[The file list shows a larger number of files. While most of these
always exist in CHM files, there are some that are unique to the
adversary's file: It contains the two pictures
]{style="font-weight: 400;"}`dogecoin.png`[ and
]{style="font-weight: 400;"}`doge.jpg`[ and the two HTML files
]{style="font-weight: 400;"}`doc.htm`[ and
]{style="font-weight: 400;"}`doc1.htm`[. The file
]{style="font-weight: 400;"}`doc1.htm`[ does not contain a lot of
information besides a minimal HTML document that includes
]{style="font-weight: 400;"}`doge.jpg`[ and a reference to the
Dogescript programming language. The file
]{style="font-weight: 400;"}`doc.htm`[ is much more interesting. This
HTML file contains an ]{style="font-weight: 400;"}`HTML OBJECT`[ tag
with the classid value
]{style="font-weight: 400;"}`clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11`[.
This ID references the ]{style="font-weight: 400;"}`hhctrl.ocx`[ ActiveX
control that can be used to start arbitrary commands when the object is
clicked. The click is then simulated using a script tag by simply
calling the ]{style="font-weight: 400;"}`click()`[ method on the HTML
object.]{style="font-weight: 400;"}

[Therefore, our next step should be to further analyze the command that
the attackers try to run. The command embedded in the HTML object
contains a call to Windows PowerShell:]{style="font-weight: 400;"}

::: {#attachment_128529 .wp-caption .alignnone style="width: 2597px"}
[![](./catapult-spider-adversary-quest-walkthrough-2022_files/Picture1-5.png){.wp-image-128529
.size-full width="2587" height="779"
sizes="(max-width: 2587px) 100vw, 2587px"
srcset="https://www.crowdstrike.com/wp-content/uploads/2022/08/Picture1-5.png 2587w, https://www.crowdstrike.com/wp-content/uploads/2022/08/Picture1-5-300x90.png 300w, https://www.crowdstrike.com/wp-content/uploads/2022/08/Picture1-5-1024x308.png 1024w, https://www.crowdstrike.com/wp-content/uploads/2022/08/Picture1-5-768x231.png 768w, https://www.crowdstrike.com/wp-content/uploads/2022/08/Picture1-5-1536x463.png 1536w, https://www.crowdstrike.com/wp-content/uploads/2022/08/Picture1-5-2048x617.png 2048w"}](./catapult-spider-adversary-quest-walkthrough-2022_files/Picture1-5.png)

(Click to enlarge)
:::

[The command calls PowerShell with the parameter
]{style="font-weight: 400;"}`-EncodedCommand`[ which allows the use of
inline PowerShell scripts encoded in Base64. We can easily decode the
program using the ]{style="font-weight: 400;"}`base64`[ command line
tool from the GNU coreutils. The following command extracts the
string:]{style="font-weight: 400;"}

![](./catapult-spider-adversary-quest-walkthrough-2022_files/Picture1-6-1024x54.png){.alignnone
.size-large .wp-image-128533 width="1024" height="54"
sizes="(max-width: 1024px) 100vw, 1024px"
srcset="https://www.crowdstrike.com/wp-content/uploads/2022/08/Picture1-6-1024x54.png 1024w, https://www.crowdstrike.com/wp-content/uploads/2022/08/Picture1-6-300x16.png 300w, https://www.crowdstrike.com/wp-content/uploads/2022/08/Picture1-6-768x41.png 768w, https://www.crowdstrike.com/wp-content/uploads/2022/08/Picture1-6-1536x81.png 1536w, https://www.crowdstrike.com/wp-content/uploads/2022/08/Picture1-6-2048x109.png 2048w"}

[Then we can decode the PowerShell script:]{style="font-weight: 400;"}

![](./catapult-spider-adversary-quest-walkthrough-2022_files/Picture1-7-1024x92.png){.alignnone
.size-large .wp-image-128534 width="1024" height="92"
sizes="(max-width: 1024px) 100vw, 1024px"
srcset="https://www.crowdstrike.com/wp-content/uploads/2022/08/Picture1-7-1024x92.png 1024w, https://www.crowdstrike.com/wp-content/uploads/2022/08/Picture1-7-300x27.png 300w, https://www.crowdstrike.com/wp-content/uploads/2022/08/Picture1-7-768x69.png 768w, https://www.crowdstrike.com/wp-content/uploads/2022/08/Picture1-7-1536x138.png 1536w, https://www.crowdstrike.com/wp-content/uploads/2022/08/Picture1-7-2048x184.png 2048w"}

[Notably, the extracted command is encoded using UTF-16 little-endian,
which is necessary for the program to be executed by PowerShell. For
easier analysis we can convert it to UTF-8:]{style="font-weight: 400;"}

![](./catapult-spider-adversary-quest-walkthrough-2022_files/Picture1-8-1024x68.png){.alignnone
.size-large .wp-image-128535 width="1024" height="68"
sizes="(max-width: 1024px) 100vw, 1024px"
srcset="https://www.crowdstrike.com/wp-content/uploads/2022/08/Picture1-8-1024x68.png 1024w, https://www.crowdstrike.com/wp-content/uploads/2022/08/Picture1-8-300x20.png 300w, https://www.crowdstrike.com/wp-content/uploads/2022/08/Picture1-8-768x51.png 768w, https://www.crowdstrike.com/wp-content/uploads/2022/08/Picture1-8-1536x103.png 1536w, https://www.crowdstrike.com/wp-content/uploads/2022/08/Picture1-8-2048x137.png 2048w"}

[This gives us a program that we can further beautify to the following
script (line breaks added for better
readability):]{style="font-weight: 400;"}

::: {#attachment_128536 .wp-caption .alignnone style="width: 2862px"}
[![](./catapult-spider-adversary-quest-walkthrough-2022_files/Picture1-9.png){.wp-image-128536
.size-full width="2852" height="591"
sizes="(max-width: 2852px) 100vw, 2852px"
srcset="https://www.crowdstrike.com/wp-content/uploads/2022/08/Picture1-9.png 2852w, https://www.crowdstrike.com/wp-content/uploads/2022/08/Picture1-9-300x62.png 300w, https://www.crowdstrike.com/wp-content/uploads/2022/08/Picture1-9-1024x212.png 1024w, https://www.crowdstrike.com/wp-content/uploads/2022/08/Picture1-9-768x159.png 768w, https://www.crowdstrike.com/wp-content/uploads/2022/08/Picture1-9-1536x318.png 1536w, https://www.crowdstrike.com/wp-content/uploads/2022/08/Picture1-9-2048x424.png 2048w"}](./catapult-spider-adversary-quest-walkthrough-2022_files/Picture1-9.png)

(Click to enlarge)
:::

[The first line of the script contains another Base64 encoded string
that is decoded using the function
]{style="font-weight: 400;"}`Get-Decode()`[, which is defined in lines 2
to 6. Looking at the function we can see that the function decodes a
Base64 input string then XORs the result with 42. There are multiple
ways of replicating the decoding of the string. One easy way would be to
use cyberchef with ]{style="font-weight: 400;"}[[this
recipe]{style="font-weight: 400;"}](https://gchq.github.io/CyberChef/#recipe=From_Base64('A-Za-z0-9%2B/%3D',true)XOR(%7B'option':'Decimal','string':'42'%7D,'Standard',false)&input=SFI4WUhSZ2VFaDRjRXdZU0doSWFCazlFU1ZoVFdsNVBXQVJQVWs4R1NVVkVYbGhGUmdSUFVrOEdXRXRFV1VWSFJFVmVUM1ZNUmt0TkJFOVNUdz09)[.
We could also install PowerShell and just use the readily implemented
function:]{style="font-weight: 400;"}

::: {#attachment_128538 .wp-caption .alignnone style="width: 4866px"}
[![](./catapult-spider-adversary-quest-walkthrough-2022_files/Picture1-10.png){.wp-image-128538
.size-full width="4856" height="1027"
sizes="(max-width: 4856px) 100vw, 4856px"
srcset="https://www.crowdstrike.com/wp-content/uploads/2022/08/Picture1-10.png 4856w, https://www.crowdstrike.com/wp-content/uploads/2022/08/Picture1-10-300x63.png 300w, https://www.crowdstrike.com/wp-content/uploads/2022/08/Picture1-10-1024x217.png 1024w, https://www.crowdstrike.com/wp-content/uploads/2022/08/Picture1-10-768x162.png 768w, https://www.crowdstrike.com/wp-content/uploads/2022/08/Picture1-10-1536x325.png 1536w, https://www.crowdstrike.com/wp-content/uploads/2022/08/Picture1-10-2048x433.png 2048w"}](./catapult-spider-adversary-quest-walkthrough-2022_files/Picture1-10.png)

(Click to enlarge)
:::

[This gives us a comma-separated list of two numbers and four strings
that appear to be filenames.]{style="font-weight: 400;"}

[The script above subtracts the constant
]{style="font-weight: 400;"}`[uint32]::MaxValue`[ from the first number
and encodes the result in hexadecimal notation. The script then iterates
over the last three filenames in the decoded string (lines 8-14) and for
each of them:]{style="font-weight: 400;"}

-   [Generates a list of strings (lines
    9-11)]{style="font-weight: 400;"}
-   [Uses that list to build a URL and download a file (line
    12)]{style="font-weight: 400;"}
-   [Starts that downloaded file (line 13)]{style="font-weight: 400;"}

[In order to figure out where the files are located, we need to find out
what the URL looks like. The uint32 maximum value is 4294967295.
Subtracting this from the number gives us 3232266753. The hexadecimal
representation can be calculated using most scientific calculators,
]{style="font-weight: 400;"}[[cyberchef]{style="font-weight: 400;"}](https://gchq.github.io/CyberChef/#recipe=Subtract('Space')To_Base(16)&input=NzUyNzI0ODQ2OSA0Mjk0OTY3Mjk1)[
or the Python ]{style="font-weight: 400;"}`hex()`[
function:]{style="font-weight: 400;"}

![](./catapult-spider-adversary-quest-walkthrough-2022_files/Picture1-11-1024x155.png){.alignnone
.wp-image-128539 .size-large width="1024" height="155"
sizes="(max-width: 1024px) 100vw, 1024px"
srcset="https://www.crowdstrike.com/wp-content/uploads/2022/08/Picture1-11-1024x155.png 1024w, https://www.crowdstrike.com/wp-content/uploads/2022/08/Picture1-11-300x45.png 300w, https://www.crowdstrike.com/wp-content/uploads/2022/08/Picture1-11-768x116.png 768w, https://www.crowdstrike.com/wp-content/uploads/2022/08/Picture1-11-1536x232.png 1536w, https://www.crowdstrike.com/wp-content/uploads/2022/08/Picture1-11-2048x309.png 2048w"}

[The output value of the Powershell hex encoding is
]{style="font-weight: 400;"}`c0a87a01`[ and this is stored as the first
value (i.e. at index 0) of the string list. The second value of the list
is a SHA-256 hash of this value, which can be calculated by using
]{style="font-weight: 400;"}[[cyberchef]{style="font-weight: 400;"}](https://gchq.github.io/CyberChef/#recipe=Subtract('Space')To_Base(16)SHA2('256',64,160)To_Upper_case('All')&input=NzUyNzI0ODQ2OSA0Mjk0OTY3Mjk1)[
or Python:]{style="font-weight: 400;"}

![](./catapult-spider-adversary-quest-walkthrough-2022_files/Picture1-12-1024x71.png){.alignnone
.size-large .wp-image-128541 width="1024" height="71"
sizes="(max-width: 1024px) 100vw, 1024px"
srcset="https://www.crowdstrike.com/wp-content/uploads/2022/08/Picture1-12-1024x71.png 1024w, https://www.crowdstrike.com/wp-content/uploads/2022/08/Picture1-12-300x21.png 300w, https://www.crowdstrike.com/wp-content/uploads/2022/08/Picture1-12-768x53.png 768w, https://www.crowdstrike.com/wp-content/uploads/2022/08/Picture1-12-1536x106.png 1536w, https://www.crowdstrike.com/wp-content/uploads/2022/08/Picture1-12-2048x142.png 2048w"}

[The third parameter (i.e., at index 2) is the file name used in the
current iteration. The fifth parameter is the second number from the
initial encoded string: 42666.]{style="font-weight: 400;"}

[The rest of the list is just populated by the verbatim strings listed
there. The script then combines these strings to a URL in a different
order, as can be seen in line 12 of the script. With this information we
can recreate one of the URLs:]{style="font-weight: 400;"}

::: {#attachment_128544 .wp-caption .alignnone style="width: 16394px"}
[![](./catapult-spider-adversary-quest-walkthrough-2022_files/Picture1.jpg){.wp-image-128544
.size-full width="16384"
height="652"}](./catapult-spider-adversary-quest-walkthrough-2022_files/Picture1.jpg)

(Click to enlarge)
:::

[From this encoding it is clear that the first part of the URL after the
http protocol identifier is the hexadecimal encoding of an IP
address.]{style="font-weight: 400;"}

[This means that in order for us to find the location of the samples on
the new command-and-control server IP, we need to construct a similar
URL based on the hexadecimal encoding of the new IP. Based on the URL
above, we now know we should use http on TCP port 42666 and search for
the files in a folder that is the hexadecimal representation of the
SHA256 hash of the hexadecimal encoding of the C2 IP. The hash can be
generated using cyberchef
(]{style="font-weight: 400;"}[[recipe]{style="font-weight: 400;"}](https://gchq.github.io/CyberChef/#recipe=Change_IP_format('Dotted%20Decimal','Hex')SHA2('256',64,160)&input=MTI3LjAuMC4x)[)
or by writing a short Python snippet like the
following:]{style="font-weight: 400;"}

::: {#attachment_128545 .wp-caption .alignnone style="width: 7589px"}
[![](./catapult-spider-adversary-quest-walkthrough-2022_files/Picture1-15.png){.wp-image-128545
.size-full width="7579" height="499"
sizes="(max-width: 7579px) 100vw, 7579px"
srcset="https://www.crowdstrike.com/wp-content/uploads/2022/08/Picture1-15.png 7579w, https://www.crowdstrike.com/wp-content/uploads/2022/08/Picture1-15-300x20.png 300w, https://www.crowdstrike.com/wp-content/uploads/2022/08/Picture1-15-1024x67.png 1024w, https://www.crowdstrike.com/wp-content/uploads/2022/08/Picture1-15-768x51.png 768w, https://www.crowdstrike.com/wp-content/uploads/2022/08/Picture1-15-1536x101.png 1536w, https://www.crowdstrike.com/wp-content/uploads/2022/08/Picture1-15-2048x135.png 2048w"}](./catapult-spider-adversary-quest-walkthrough-2022_files/Picture1-15.png)

(Click to enlarge)
:::

[Based on the generated values we can now construct the correct URL to
retrieve
]{style="font-weight: 400;"}[ransomnote\_flag.exe,]{style="font-weight: 400;"}[
which -- as the name suggests -- should contain the
flag:]{style="font-weight: 400;"}

    "http[:]//116.202.161.100:42666/F5D3271FE6D59C185D85353DFB8794A4FF9B7BDD5661FCCF356766998B6D276B/ransomnote_flag.exe"

[After downloading the file, one possible way of getting the flag is by
running the EXE file. It will show us the ransom note along with the
flag.]{style="font-weight: 400;"}

::: {#attachment_128547 .wp-caption .alignnone style="width: 1987px"}
[![](./catapult-spider-adversary-quest-walkthrough-2022_files/Picture1-16.png){.wp-image-128547
.size-full width="1977" height="1218"
sizes="(max-width: 1977px) 100vw, 1977px"
srcset="https://www.crowdstrike.com/wp-content/uploads/2022/08/Picture1-16.png 1977w, https://www.crowdstrike.com/wp-content/uploads/2022/08/Picture1-16-300x185.png 300w, https://www.crowdstrike.com/wp-content/uploads/2022/08/Picture1-16-1024x631.png 1024w, https://www.crowdstrike.com/wp-content/uploads/2022/08/Picture1-16-768x473.png 768w, https://www.crowdstrike.com/wp-content/uploads/2022/08/Picture1-16-1536x946.png 1536w"}](./catapult-spider-adversary-quest-walkthrough-2022_files/Picture1-16.png)

(Click to enlarge)
:::

[A better way of recovering the flag is to run strings on the
file:]{style="font-weight: 400;"}

![](./catapult-spider-adversary-quest-walkthrough-2022_files/Picture1-17-1024x112.png){.alignnone
.size-large .wp-image-128551 width="1024" height="112"
sizes="(max-width: 1024px) 100vw, 1024px"
srcset="https://www.crowdstrike.com/wp-content/uploads/2022/08/Picture1-17-1024x112.png 1024w, https://www.crowdstrike.com/wp-content/uploads/2022/08/Picture1-17-300x33.png 300w, https://www.crowdstrike.com/wp-content/uploads/2022/08/Picture1-17-768x84.png 768w, https://www.crowdstrike.com/wp-content/uploads/2022/08/Picture1-17-1536x168.png 1536w, https://www.crowdstrike.com/wp-content/uploads/2022/08/Picture1-17-2048x224.png 2048w"}

**Challenge \#2: Such Control Wow**
-----------------------------------

*[The ransomware was installed on a customer's computer via a malicious
CHM file. The PowerShell script that you analyzed previously installed
multiple second stage binaries, including a binary that enables CATAPULT
SPIDER to control the execution of the ransomware. The ransomware has
locked the customer completely out of their machines and encrypted their
data. The customer does not want to pay the ransom and has asked us for
help in unlocking one of their systems. Can you find a way to unlock the
machine without paying the ransom? We have obtained a version of the
control binary for you to analyze. The locked machine is reachable at
the IP 116.202.161.100.]{style="font-weight: 400;"}*

[The challenge provides a version of
]{style="font-weight: 400;"}`control.exe`[ that is running on a machine
infected through CATAPULT SPIDER's phishing document. In order to
identify potential weaknesses in the control binary, we must analyze how
the control protocol works and how we can potentially unlock the victim
machine.]{style="font-weight: 400;"}

### [Analyzing the Binary]{style="font-weight: 400;"}

[Running the ]{style="font-weight: 400;"}`file`[ command on the malware
reveals the file is a Windows PE executable for
x86-64:]{style="font-weight: 400;"}

![](./catapult-spider-adversary-quest-walkthrough-2022_files/Picture1-18-1024x94.png){.alignnone
.size-large .wp-image-128636 width="1024" height="94"
sizes="(max-width: 1024px) 100vw, 1024px"
srcset="https://www.crowdstrike.com/wp-content/uploads/2022/08/Picture1-18-1024x94.png 1024w, https://www.crowdstrike.com/wp-content/uploads/2022/08/Picture1-18-300x28.png 300w, https://www.crowdstrike.com/wp-content/uploads/2022/08/Picture1-18-768x71.png 768w, https://www.crowdstrike.com/wp-content/uploads/2022/08/Picture1-18-1536x141.png 1536w, https://www.crowdstrike.com/wp-content/uploads/2022/08/Picture1-18-2048x189.png 2048w"}

[Running the malware in Windows gives us the following
output:]{style="font-weight: 400;"}

![](./catapult-spider-adversary-quest-walkthrough-2022_files/Picture1-19-1024x119.png){.alignnone
.size-large .wp-image-128637 width="1024" height="119"
sizes="(max-width: 1024px) 100vw, 1024px"
srcset="https://www.crowdstrike.com/wp-content/uploads/2022/08/Picture1-19-1024x119.png 1024w, https://www.crowdstrike.com/wp-content/uploads/2022/08/Picture1-19-300x35.png 300w, https://www.crowdstrike.com/wp-content/uploads/2022/08/Picture1-19-768x89.png 768w, https://www.crowdstrike.com/wp-content/uploads/2022/08/Picture1-19-1536x178.png 1536w, https://www.crowdstrike.com/wp-content/uploads/2022/08/Picture1-19-2048x238.png 2048w"}

[The output following DOGE appears to randomly change on each execution
of the malware. After running ]{style="font-weight: 400;"}`strings`[ on
the file we notice it contains many human-readable strings, most of them
clearly related to JavaScript. Looking for parts of the previously
observed output allows us to find out a little more (the
]{style="font-weight: 400;"}`-td`[ parameter to
]{style="font-weight: 400;"}`strings`[ returns the decimal offset within
the file):]{style="font-weight: 400;"}

::: {#attachment_128638 .wp-caption .alignnone style="width: 4674px"}
[![](./catapult-spider-adversary-quest-walkthrough-2022_files/Picture1-20.png){.wp-image-128638
.size-full width="4664" height="687"
sizes="(max-width: 4664px) 100vw, 4664px"
srcset="https://www.crowdstrike.com/wp-content/uploads/2022/08/Picture1-20.png 4664w, https://www.crowdstrike.com/wp-content/uploads/2022/08/Picture1-20-300x44.png 300w, https://www.crowdstrike.com/wp-content/uploads/2022/08/Picture1-20-1024x151.png 1024w, https://www.crowdstrike.com/wp-content/uploads/2022/08/Picture1-20-768x113.png 768w, https://www.crowdstrike.com/wp-content/uploads/2022/08/Picture1-20-1536x226.png 1536w, https://www.crowdstrike.com/wp-content/uploads/2022/08/Picture1-20-2048x302.png 2048w"}](./catapult-spider-adversary-quest-walkthrough-2022_files/Picture1-20.png)

(Click to enlarge)
:::

[This shows that the output is part of a larger piece of source code
that is contained inside the binary file. Aligning with previous
]{style="font-weight: 400;"}[[TTPs]{style="font-weight: 400;"}](https://www.crowdstrike.com/blog/adversary-quest-walkthrough-four-catapult-spider-ecrime-challenges/)[
of the actor, this code appears to be
]{style="font-weight: 400;"}[[Dogescript]{style="font-weight: 400;"}](https://github.com/dogescript/dogescript)[
again. The Dogescript language compiles to JavaScript and can then be
executed by a JavaScript engine. The
]{style="font-weight: 400;"}[[language
definition]{style="font-weight: 400;"}](https://github.com/dogescript/dogescript/blob/master/LANGUAGE.md)[
can help us to make sense of what we are seeing. Either by reviewing
what we ]{style="font-weight: 400;"}[[already know about CATAPULT
SPIDER]{style="font-weight: 400;"}](https://www.crowdstrike.com/blog/adversary-quest-walkthrough-four-catapult-spider-ecrime-challenges/)[
or by further analyzing the binary, we can arrive at the conclusion that
this binary was again built using
]{style="font-weight: 400;"}[[nexe]{style="font-weight: 400;"}](https://github.com/nexe/nexe)[
in order to generate the binary file from a
]{style="font-weight: 400;"}[[node.js]{style="font-weight: 400;"}](https://nodejs.org/en/)[
application. This means that we should be able to find nexe's resources
definition within the binary that gives us information about all
embedded source files and their relative offsets. We can find the
resources in the binary using
]{style="font-weight: 400;"}`grep`[:]{style="font-weight: 400;"}

::: {#attachment_128639 .wp-caption .alignnone style="width: 3543px"}
[![](./catapult-spider-adversary-quest-walkthrough-2022_files/Picture1-21.png){.wp-image-128639
.size-full width="3533" height="341"
sizes="(max-width: 3533px) 100vw, 3533px"
srcset="https://www.crowdstrike.com/wp-content/uploads/2022/08/Picture1-21.png 3533w, https://www.crowdstrike.com/wp-content/uploads/2022/08/Picture1-21-300x29.png 300w, https://www.crowdstrike.com/wp-content/uploads/2022/08/Picture1-21-1024x99.png 1024w, https://www.crowdstrike.com/wp-content/uploads/2022/08/Picture1-21-768x74.png 768w, https://www.crowdstrike.com/wp-content/uploads/2022/08/Picture1-21-1536x148.png 1536w, https://www.crowdstrike.com/wp-content/uploads/2022/08/Picture1-21-2048x198.png 2048w"}](./catapult-spider-adversary-quest-walkthrough-2022_files/Picture1-21.png)

(Click to enlarge)
:::

[We see there is a `.`]{style="font-weight: 400;"}`djs`[ file named
]{style="font-weight: 400;"}`server.djs`[, which is likely the file we
initially found, since it is the only Dogescript file. The first listed
file is ]{style="font-weight: 400;"}`control.js`[, which likely loads
and executes the Dogescript file. By searching for
]{style="font-weight: 400;"}`server.djs`[ in the binary, we can find
what is likely the embedded ]{style="font-weight: 400;"}`control.js`[
file in the second line shown below:]{style="font-weight: 400;"}

::: {#attachment_128640 .wp-caption .alignnone style="width: 3051px"}
[![](./catapult-spider-adversary-quest-walkthrough-2022_files/Picture1-22.png){.wp-image-128640
.size-full width="3041" height="547"
sizes="(max-width: 3041px) 100vw, 3041px"
srcset="https://www.crowdstrike.com/wp-content/uploads/2022/08/Picture1-22.png 3041w, https://www.crowdstrike.com/wp-content/uploads/2022/08/Picture1-22-300x54.png 300w, https://www.crowdstrike.com/wp-content/uploads/2022/08/Picture1-22-1024x184.png 1024w, https://www.crowdstrike.com/wp-content/uploads/2022/08/Picture1-22-768x138.png 768w, https://www.crowdstrike.com/wp-content/uploads/2022/08/Picture1-22-1536x276.png 1536w, https://www.crowdstrike.com/wp-content/uploads/2022/08/Picture1-22-2048x368.png 2048w"}](./catapult-spider-adversary-quest-walkthrough-2022_files/Picture1-22.png)

(Click to enlarge)
:::

[This allows us to guess the absolute offset of what nexe considers
relative offset 0 inside the resources index. Looking at the line, it
would be reasonable to assume the control script starts with
]{style="font-weight: 400;"}`const lefs = [...] `[at absolute offset
56506510 plus 10 characters. Using this information and the length of
the file given in the resource, object
(]{style="font-weight: 400;"}`189`[) should give us the
]{style="font-weight: 400;"}`control.js`[
file:]{style="font-weight: 400;"}

::: {#attachment_128641 .wp-caption .alignnone style="width: 4139px"}
[![](./catapult-spider-adversary-quest-walkthrough-2022_files/Picture1-23.png){.size-full
.wp-image-128641 width="4129" height="529"
sizes="(max-width: 4129px) 100vw, 4129px"
srcset="https://www.crowdstrike.com/wp-content/uploads/2022/08/Picture1-23.png 4129w, https://www.crowdstrike.com/wp-content/uploads/2022/08/Picture1-23-300x38.png 300w, https://www.crowdstrike.com/wp-content/uploads/2022/08/Picture1-23-1024x131.png 1024w, https://www.crowdstrike.com/wp-content/uploads/2022/08/Picture1-23-768x98.png 768w, https://www.crowdstrike.com/wp-content/uploads/2022/08/Picture1-23-1536x197.png 1536w, https://www.crowdstrike.com/wp-content/uploads/2022/08/Picture1-23-2048x262.png 2048w"}](./catapult-spider-adversary-quest-walkthrough-2022_files/Picture1-23.png)

(Click to enlarge)
:::

[This does appear to be a reasonable loader for the
]{style="font-weight: 400;"}`server.djs `[Dogescript file. It loads the
]{style="font-weight: 400;"}`fs`[ and
]{style="font-weight: 400;"}`dogescript`[ modules and then reads,
compiles, and executes the ]{style="font-weight: 400;"}`server.djs`[,
which should contain most, if not all relevant adversary code. By using
the absolute offset of ]{style="font-weight: 400;"}`control.js`[ plus
the offset and length listed in the resource object, we are able to
extract
]{style="font-weight: 400;"}[`server.djs`:]{style="font-weight: 400;"}

![](./catapult-spider-adversary-quest-walkthrough-2022_files/Picture1-24-1024x54.png){.alignnone
.size-large .wp-image-128643 width="1024" height="54"
sizes="(max-width: 1024px) 100vw, 1024px"
srcset="https://www.crowdstrike.com/wp-content/uploads/2022/08/Picture1-24-1024x54.png 1024w, https://www.crowdstrike.com/wp-content/uploads/2022/08/Picture1-24-300x16.png 300w, https://www.crowdstrike.com/wp-content/uploads/2022/08/Picture1-24-768x41.png 768w, https://www.crowdstrike.com/wp-content/uploads/2022/08/Picture1-24-1536x81.png 1536w, https://www.crowdstrike.com/wp-content/uploads/2022/08/Picture1-24-2048x108.png 2048w"}

### **Looking at the Code**

[At the very end of the script file, we can see it uses the JavaScript
]{style="font-weight: 400;"}`http`[ module to start a HTTP server. HTTP
requests are handled by the
]{style="font-weight: 400;"}`routeRequest() `[Dogescript function that
is called in line 446:]{style="font-weight: 400;"}

![](./catapult-spider-adversary-quest-walkthrough-2022_files/Picture1-25-1024x458.png){.alignnone
.size-large .wp-image-128644 width="1024" height="458"
sizes="(max-width: 1024px) 100vw, 1024px"
srcset="https://www.crowdstrike.com/wp-content/uploads/2022/08/Picture1-25-1024x458.png 1024w, https://www.crowdstrike.com/wp-content/uploads/2022/08/Picture1-25-300x134.png 300w, https://www.crowdstrike.com/wp-content/uploads/2022/08/Picture1-25-768x343.png 768w, https://www.crowdstrike.com/wp-content/uploads/2022/08/Picture1-25.png 1327w"}

[Looking at ]{style="font-weight: 400;"}`routeRequest()`[ we can see
that it first analyzes the request URL and then uses the URL path in a
switch statement:]{style="font-weight: 400;"}

::: {#attachment_128645 .wp-caption .alignnone style="width: 2410px"}
[![](./catapult-spider-adversary-quest-walkthrough-2022_files/Picture1-26.png){.wp-image-128645
.size-full width="2400" height="837"
sizes="(max-width: 2400px) 100vw, 2400px"
srcset="https://www.crowdstrike.com/wp-content/uploads/2022/08/Picture1-26.png 2400w, https://www.crowdstrike.com/wp-content/uploads/2022/08/Picture1-26-300x105.png 300w, https://www.crowdstrike.com/wp-content/uploads/2022/08/Picture1-26-1024x357.png 1024w, https://www.crowdstrike.com/wp-content/uploads/2022/08/Picture1-26-768x268.png 768w, https://www.crowdstrike.com/wp-content/uploads/2022/08/Picture1-26-1536x536.png 1536w, https://www.crowdstrike.com/wp-content/uploads/2022/08/Picture1-26-2048x714.png 2048w"}](./catapult-spider-adversary-quest-walkthrough-2022_files/Picture1-26.png)

(Click to enlarge)
:::

[This gives us the potential paths ]{style="font-weight: 400;"}`/auth`[,
]{style="font-weight: 400;"}`/readfile`[,
]{style="font-weight: 400;"}`/dirlist`[,
]{style="font-weight: 400;"}`/unlock`[,
]{style="font-weight: 400;"}`/decrypt`[,
]{style="font-weight: 400;"}`/wipe`[ and
]{style="font-weight: 400;"}`/logout`[ that are the principal endpoints
available through an HTTP API. Most endpoints only support the HTTP GET
method, while the ]{style="font-weight: 400;"}`/auth`[ endpoint also
supports HTTP POST.]{style="font-weight: 400;"}

[Closer inspection shows the variable
]{style="font-weight: 400;"}`authorized`[ is set by the function call
]{style="font-weight: 400;"}`checkAuth(request) `[in the second line of
the function ]{style="font-weight: 400;"}`routeRequest()`[. We can see
this used for the ]{style="font-weight: 400;"}`/auth`[ endpoint in the
picture above. When requested via HTTP GET, that endpoint simply tells
the user whether they are currently authenticated or not. The username
for this is extracted from the cookie
]{style="font-weight: 400;"}`session`[ by
]{style="font-weight: 400;"}`getUserSession()`[ while the
]{style="font-weight: 400;"}`cookie`[ object itself is created by the
function ]{style="font-weight: 400;"}`parseCookies()`[ earlier. By
looking at the other endpoints, we can see all other API endpoints are
protected in a similar way. Only the
]{style="font-weight: 400;"}`/logout`[ endpoint and the
]{style="font-weight: 400;"}`/auth`[ endpoint's POST method do not have
any authentication checks. It therefore seems reasonable to look at the
implementation of the functions
]{style="font-weight: 400;"}`parseCookies()`[ and
]{style="font-weight: 400;"}`checkAuth()`[:]{style="font-weight: 400;"}

::: {#attachment_128646 .wp-caption .alignnone style="width: 1720px"}
[![](./catapult-spider-adversary-quest-walkthrough-2022_files/Picture1-27.png){.wp-image-128646
.size-full width="1710" height="1381"
sizes="(max-width: 1710px) 100vw, 1710px"
srcset="https://www.crowdstrike.com/wp-content/uploads/2022/08/Picture1-27.png 1710w, https://www.crowdstrike.com/wp-content/uploads/2022/08/Picture1-27-300x242.png 300w, https://www.crowdstrike.com/wp-content/uploads/2022/08/Picture1-27-1024x827.png 1024w, https://www.crowdstrike.com/wp-content/uploads/2022/08/Picture1-27-768x620.png 768w, https://www.crowdstrike.com/wp-content/uploads/2022/08/Picture1-27-1536x1240.png 1536w"}](./catapult-spider-adversary-quest-walkthrough-2022_files/Picture1-27.png)

(Click to enlarge)
:::

[The ]{style="font-weight: 400;"}`parseCookie()`[ function splits the
cookie header at all semicolons, thereby effectively going through each
transmitted cookie, and an object is created by storing cookie values in
fields named after cookie names. The
]{style="font-weight: 400;"}`checkAuth()`[ function similarly iterates
over all cookies but also checks whether the cookie value exists as a
file inside a folder if the cookie name is
]{style="font-weight: 400;"}`session`[. This behavior can be seen in
line 45, where the file path that will be checked is built using the
path module. If the file exists, the function instantly returns true.
The corresponding JavaScript code would be:]{style="font-weight: 400;"}

`var sessionPath = path.join(AuthStore, session);`

[A potential problem with this authentication check is that it is
vulnerable to a path traversal. If we can set the path to a filename
that we know exists on every Windows installation, we should be able to
get the function to return true without knowing the value of any
existing session in the ]{style="font-weight: 400;"}`AuthStore`[ path.
We can test this hypothesis by running the following
]{style="font-weight: 400;"}`curl`[ command against the
server:]{style="font-weight: 400;"}

![](./catapult-spider-adversary-quest-walkthrough-2022_files/Picture1-28.png){.alignnone
.size-full .wp-image-128648 width="7593" height="535"
sizes="(max-width: 7593px) 100vw, 7593px"
srcset="https://www.crowdstrike.com/wp-content/uploads/2022/08/Picture1-28.png 7593w, https://www.crowdstrike.com/wp-content/uploads/2022/08/Picture1-28-300x21.png 300w, https://www.crowdstrike.com/wp-content/uploads/2022/08/Picture1-28-1024x72.png 1024w, https://www.crowdstrike.com/wp-content/uploads/2022/08/Picture1-28-768x54.png 768w, https://www.crowdstrike.com/wp-content/uploads/2022/08/Picture1-28-1536x108.png 1536w, https://www.crowdstrike.com/wp-content/uploads/2022/08/Picture1-28-2048x144.png 2048w"}

[The response tells us the session is not authorized, but the value of
the variable authorized is actually ]{style="font-weight: 400;"}`true`[.
However, the value for the user is in fact
]{style="font-weight: 400;"}`null`[ and this is checked as well on all
endpoints. Looking at line 151 of the source code, we can see the cookie
value for the session cookie is passed into the
]{style="font-weight: 400;"}`getUserSession()`[
function:]{style="font-weight: 400;"}

::: {#attachment_128649 .wp-caption .alignnone style="width: 3282px"}
[![](./catapult-spider-adversary-quest-walkthrough-2022_files/Picture1-29.png){.wp-image-128649
.size-full width="3272" height="793"
sizes="(max-width: 3272px) 100vw, 3272px"
srcset="https://www.crowdstrike.com/wp-content/uploads/2022/08/Picture1-29.png 3272w, https://www.crowdstrike.com/wp-content/uploads/2022/08/Picture1-29-300x73.png 300w, https://www.crowdstrike.com/wp-content/uploads/2022/08/Picture1-29-1024x248.png 1024w, https://www.crowdstrike.com/wp-content/uploads/2022/08/Picture1-29-768x186.png 768w, https://www.crowdstrike.com/wp-content/uploads/2022/08/Picture1-29-1536x372.png 1536w, https://www.crowdstrike.com/wp-content/uploads/2022/08/Picture1-29-2048x496.png 2048w"}](./catapult-spider-adversary-quest-walkthrough-2022_files/Picture1-29.png)

(Click to enlarge)
:::

[The function tries to parse the session cookie value as a URL-safe
Base64 encoded byte array and turns it into a UTF-8 encoded string. It
then splits the resulting string on all slashes and checks that it gets
three parts. Then it returns the first part as the username. If the
Base64 decode fails, the function returns
]{style="font-weight: 400;"}`null`[ which is why the cookie that we
supplied does not yield a valid username and is therefore not accepted.
While we have found a way to circumvent one of the checks, it seems we
will need a way to find a filename that we know exists and that will
also decode as valid Base64 and also encodes two slashes as UTF-8
string. This leaves us with the following problem: While we could use a
slash in our Base64 encoded string, any use of a dot surely results in a
decoding error since the Base64 alphabet does not contain dots. However,
there is another option. Looking at the
]{style="font-weight: 400;"}`parseCookies()`[ function that is used to
build the cookie object, we should notice that if this function were to
encounter multiple cookies with the same name, any subsequent cookie by
the same name would overwrite any prior cookie by the same name. In
contrast to that, ]{style="font-weight: 400;"}`checkAuth()`[ will return
]{style="font-weight: 400;"}`true`[ as soon as any session cookie is
found to exist as a file. Therefore, it is possible to create a cookie
header with two session cookies that allows us to satisfy both
requirements by setting two session cookies with different
values:]{style="font-weight: 400;"}

::: {#attachment_128650 .wp-caption .alignnone style="width: 1034px"}
[![](./catapult-spider-adversary-quest-walkthrough-2022_files/Picture1-30-1024x46.png){.wp-image-128650
.size-large width="1024" height="46"
sizes="(max-width: 1024px) 100vw, 1024px"
srcset="https://www.crowdstrike.com/wp-content/uploads/2022/08/Picture1-30-1024x46.png 1024w, https://www.crowdstrike.com/wp-content/uploads/2022/08/Picture1-30-300x14.png 300w, https://www.crowdstrike.com/wp-content/uploads/2022/08/Picture1-30-768x35.png 768w, https://www.crowdstrike.com/wp-content/uploads/2022/08/Picture1-30-1536x69.png 1536w, https://www.crowdstrike.com/wp-content/uploads/2022/08/Picture1-30-2048x92.png 2048w"}](https://www.crowdstrike.com/wp-content/uploads/2022/08/Picture1-30.png)

(Click to enlarge)
:::

[The response of the server shows us that we are now authorized and the
recognized username is that of the user
]{style="font-weight: 400;"}`DOGE`[ that we set inside the second
cookie.]{style="font-weight: 400;"}

[Since we are now authorized to the API, we should now be able to simply
unlock the host. Looking at the code of the
"]{style="font-weight: 400;"}`/unlock`[" endpoint, we can see that to
unlock the device we must know the contents of the file set in the
variable ]{style="font-weight: 400;"}`UNLOCK_FILE`[ with the file name
"]{style="font-weight: 400;"}`C:\\Windows\\flag.txt`[". Calling the
"]{style="font-weight: 400;"}`/readfile?filename=`[" endpoint on the
remote host gives us the flag:]{style="font-weight: 400;"}

::: {#attachment_128651 .wp-caption .alignnone style="width: 1034px"}
[![](./catapult-spider-adversary-quest-walkthrough-2022_files/Picture1-31-1024x74.png){.wp-image-128651
.size-large width="1024" height="74"
sizes="(max-width: 1024px) 100vw, 1024px"
srcset="https://www.crowdstrike.com/wp-content/uploads/2022/08/Picture1-31-1024x74.png 1024w, https://www.crowdstrike.com/wp-content/uploads/2022/08/Picture1-31-300x22.png 300w, https://www.crowdstrike.com/wp-content/uploads/2022/08/Picture1-31-768x55.png 768w, https://www.crowdstrike.com/wp-content/uploads/2022/08/Picture1-31-1536x111.png 1536w, https://www.crowdstrike.com/wp-content/uploads/2022/08/Picture1-31-2048x148.png 2048w"}](https://www.crowdstrike.com/wp-content/uploads/2022/08/Picture1-31.png)

(Click to enlarge)
:::

**Challenge \#3: So Much Bits**
-------------------------------

*[Unfortunately, after infection, the ransomware managed to encrypt all
of the customer's important files. Thanks to your help, we were able to
determine the infection path and delete the control panel as well as the
running ransomware. This also enabled us to gain access to the files on
the disk of an infected Linux host. You can find the restored files
attached. They are still encrypted, though, but at least the ransomware
left some files. Please figure out whether there is a chance to decrypt
the files without paying the ransom.]{style="font-weight: 400;"}*

[A first inspection of the files of the infected host shows the
encrypted files can be recognized by the
]{style="font-weight: 400;"}[.enc]{style="font-weight: 400;"}[ extension
that is appended to the original file name. Also, a look at the script
that was left behind reveals it probably has encrypted our files and it
communicates with a C2 server:]{style="font-weight: 400;"}

::: {#attachment_128653 .wp-caption .alignnone style="width: 1712px"}
[![](./catapult-spider-adversary-quest-walkthrough-2022_files/Picture1-32.png){.wp-image-128653
.size-full width="1702" height="1150"
sizes="(max-width: 1702px) 100vw, 1702px"
srcset="https://www.crowdstrike.com/wp-content/uploads/2022/08/Picture1-32.png 1702w, https://www.crowdstrike.com/wp-content/uploads/2022/08/Picture1-32-300x203.png 300w, https://www.crowdstrike.com/wp-content/uploads/2022/08/Picture1-32-1024x692.png 1024w, https://www.crowdstrike.com/wp-content/uploads/2022/08/Picture1-32-768x519.png 768w, https://www.crowdstrike.com/wp-content/uploads/2022/08/Picture1-32-1536x1038.png 1536w"}](./catapult-spider-adversary-quest-walkthrough-2022_files/Picture1-32.png)

(Click to enlarge)
:::

[While the deletion of ]{style="font-weight: 400;"}`encrypter.py`[ that
apparently contains the actual encryption routines is supposed to impede
our analysis, the script ]{style="font-weight: 400;"}`victim_script.py`[
contains some valuable hints. For example, the address of the C2 is
revealed and, according to the source-code comments, AES in GCM mode was
used to encrypt the files.]{style="font-weight: 400;"}

[The script also shows that the file-encryption basically consists of
three steps:]{style="font-weight: 400;"}

1.  [Generate a list of files on the host]{style="font-weight: 400;"}
2.  [Encrypt each file with AES-GCM]{style="font-weight: 400;"}
3.  [Use the function
    ]{style="font-weight: 400;"}`get_encrypted_key_db()`[ to generate
    and store a database with the keys on the
    host.]{style="font-weight: 400;"}

[The function]{style="font-weight: 400;"}` get_encrypted_key_db()`[
sends a payload --- constructed from the paths and the keys of the
encrypted files --- to the C2. Based on the function name, we assume the
C2 encrypts that payload and returns the result to be stored on the
victim machine. In particular, the protocol used to communicate with the
C2 requires:]{style="font-weight: 400;"}

1.  [The length of the key in little-endian ordering followed by the key
    itself and 4 NULL bytes]{style="font-weight: 400;"}
2.  [The length of the file path, again in little-endian ordering
    followed by the file path itself and 4 NULL
    bytes.]{style="font-weight: 400;"}

[The supposedly encrypted keys returned by
]{style="font-weight: 400;"}`get_encrypted_key_db()`[ are then written
to ]{style="font-weight: 400;"}`keys.db`[.]{style="font-weight: 400;"}

[According to the comment, the files are encrypted with AES-GCM, which
is a mode for symmetric block-ciphers like AES. It is designed to ensure
the correct origin of a ciphertext and therefore prevent
chosen-ciphertext attacks (like padding oracle attacks against CBC). The
process behind this uses a message authentication code (MAC) where a
so-called "authentication tag" is produced. This authentication tag is
generated based on the encryption key and the ciphertext. It is given as
additional data to the ciphertext. The idea is that an attacker should
not be able to produce a valid authentication tag for a tampered
ciphertext, as the attacker does not know the underlying secret to
produce it. The result is that the decryption routine is able to detect
a tampered ciphertext due to a missing valid authentication
tag.]{style="font-weight: 400;"}

[Moreover, the algorithm requires a 12-byte IV (Initialization Vector)
that is used to initialize a counter --- and this counter is used to
derive a keystream. Each block of the keystream is generated by
encrypting the current counter (which is incremented for each block)
with a key using AES, and this keystream is then used to encrypt each
block of the plaintext by XOR-ing both the plaintext and
keystream.]{style="font-weight: 400;"}

![](./catapult-spider-adversary-quest-walkthrough-2022_files/Picture1-33.png){.alignnone
.size-full .wp-image-128655 width="1247" height="1375"
sizes="(max-width: 1247px) 100vw, 1247px"
srcset="https://www.crowdstrike.com/wp-content/uploads/2022/08/Picture1-33.png 1247w, https://www.crowdstrike.com/wp-content/uploads/2022/08/Picture1-33-272x300.png 272w, https://www.crowdstrike.com/wp-content/uploads/2022/08/Picture1-33-929x1024.png 929w, https://www.crowdstrike.com/wp-content/uploads/2022/08/Picture1-33-768x847.png 768w"}

[After getting familiar with the AES-GCM, the resulting database
]{style="font-weight: 400;"}`keys.db`[ is examined. According to the
output of the ]{style="font-weight: 400;"}`file`[ command, the database
contains raw binary data.]{style="font-weight: 400;"}

[Inspection with ]{style="font-weight: 400;"}`xxd`[ reveals some
human-readable strings, however:]{style="font-weight: 400;"}

![](./catapult-spider-adversary-quest-walkthrough-2022_files/Picture1-34.png){.alignnone
.size-full .wp-image-128656 width="1614" height="620"
sizes="(max-width: 1614px) 100vw, 1614px"
srcset="https://www.crowdstrike.com/wp-content/uploads/2022/08/Picture1-34.png 1614w, https://www.crowdstrike.com/wp-content/uploads/2022/08/Picture1-34-300x115.png 300w, https://www.crowdstrike.com/wp-content/uploads/2022/08/Picture1-34-1024x393.png 1024w, https://www.crowdstrike.com/wp-content/uploads/2022/08/Picture1-34-768x295.png 768w, https://www.crowdstrike.com/wp-content/uploads/2022/08/Picture1-34-1536x590.png 1536w"}

[In particular, the blocks marked green are the file paths of the
encrypted files. This is indicated by the
]{style="font-weight: 400;"}`.enc`[ file extension. Marked in red are
strings that seem to be the last 12 characters of the file paths (green)
that follow. In between are so far unknown bytes. Suspicious are the
longer sequences of NULL bytes that are followed or preceded by single
non-NULL bytes, marked in blue.]{style="font-weight: 400;"}

[Closer investigation of the file format indicates the format is similar
to the protocol format that is used by the
]{style="font-weight: 400;"}`get_encrypted_key_db()`[ function in the
C2 communication. It contains patterns of 2 and 4 NULL-bytes
consecutively. Moreover, examining the data length between the first and
second NULL-byte pattern, it is 0x2c (= 44) bytes long. This is exactly
the value of the first byte. Hence, it is safe to assume that the first
4 bytes are an Integer length field encoded in little-endian, followed
by the data. This is then followed by 4 NULL bytes. This is repeated
until the last data block is reached, which is exactly the encoding
]{style="font-weight: 400;"}`get_encrypted_key_db() `[uses.]{style="font-weight: 400;"}

[It is also suspicious that a block with partly unknown bytes is
followed by a block that encodes a file path similar to how
]{style="font-weight: 400;"}`get_encrypted_key_db()`[ encodes a key,
followed by the file path. This is a first indicator that the former
block stands in relation to the key used to encrypt the file from the
latter block.]{style="font-weight: 400;"}

[Moreover, as explained above, AES-GCM processes a 12-byte IV. The
authentication tag in AES-GCM is 16 bytes long. Based on a size of 44
bytes (0x2c), this leaves 44 -- 12 -- 16 = 16 bytes for more data, which
would be the correct key size for AES128. Hence, we assume the 44-byte
blocks in ]{style="font-weight: 400;"}`keys.db`[ contain the encrypted
ransomware-keys that were used to encrypt the files of the infected
host. We will also assume the file paths following these blocks indicate
the file that was encrypted by the key.]{style="font-weight: 400;"}

[One last aspect of the 44-byte blocks is important: It always begins
with the last 12 bytes of the file path that follows in the next data
block. As the IV is 12 bytes in length, too, it is apparent that this IV
is derived from the last 12 bytes of the filename that is sent to the
C2. GCM requires that this IV is randomly generated, though. For this
reason, the protocol is vulnerable to a chosen-plaintext attack as the
IV is potentially reused if the same filename is used twice to encrypt
two different keys, and as it is possible to send arbitrary key-file
path pairs to the C2 as long as the encoding is
correct.]{style="font-weight: 400;"}

### **Solution**

[If we disregard the calculation of the authentication tag for a moment,
AES-GCM works as follows: The IV is used to initialize a counter. For
encrypting the first plaintext block, AES-GCM will increment the counter
and then encrypt the result with AES using an unknown key. The resulting
value, which we will call "XOR key" in the following, is then XORed
against the first plaintext block to create the first ciphertext block.
For the next block, the counter is incremented again and the process
repeats..]{style="font-weight: 400;"}

[If we assume the command-and-control server uses the same AES key for
all operations, and we can supply both the IV (i.e. partial file names)
and the plaintext (e.g. the encrypted file encryption keys), we can use
that to our advantage: By sending the same IV that was used for
encryption of a ransomware file encryption key, we can force the command
and control server to generate the same XOR key. If that XOR key is
applied to the ciphertext of the encrypted ransomware file encryption
key from ]{style="font-weight: 400;"}`keys.db`[, the XOR operation is
reversed and we receive the original plaintext key, allowing us to
decrypt the corresponding file.]{style="font-weight: 400;"}

[Whether the encrypted ransomware key is stored in the middle 16 bytes
and the authentication tag in the last 16 bytes of a 44-byte block or
vice versa can be found out by trial and error: The decryption of the
files with AES-GCM will fail due to a false authentication tag for the
wrong choice.]{style="font-weight: 400;"}

[The solution consists of implementing the outlined attack based on the
contents of ]{style="font-weight: 400;"}`keys.db`[. The following script
implements the chosen-plaintext attack:]{style="font-weight: 400;"}

::: {#attachment_128658 .wp-caption .alignnone style="width: 1437px"}
[![](./catapult-spider-adversary-quest-walkthrough-2022_files/Picture1-35.png){.wp-image-128658
.size-full width="1427" height="1922"
sizes="(max-width: 1427px) 100vw, 1427px"
srcset="https://www.crowdstrike.com/wp-content/uploads/2022/08/Picture1-35.png 1427w, https://www.crowdstrike.com/wp-content/uploads/2022/08/Picture1-35-223x300.png 223w, https://www.crowdstrike.com/wp-content/uploads/2022/08/Picture1-35-760x1024.png 760w, https://www.crowdstrike.com/wp-content/uploads/2022/08/Picture1-35-768x1034.png 768w, https://www.crowdstrike.com/wp-content/uploads/2022/08/Picture1-35-1140x1536.png 1140w"}](./catapult-spider-adversary-quest-walkthrough-2022_files/Picture1-35.png)

(Click to enlarge)
:::

[Running the script gives us the following result, including our flag,
]{style="font-weight: 400;"}`CS{d0g3_s0_n1c3_such_4m4z3}`[:]{style="font-weight: 400;"}

::: {#attachment_128659 .wp-caption .alignnone style="width: 1034px"}
[![](./catapult-spider-adversary-quest-walkthrough-2022_files/Picture1-36-1024x110.png){.wp-image-128659
.size-large width="1024" height="110"
sizes="(max-width: 1024px) 100vw, 1024px"
srcset="https://www.crowdstrike.com/wp-content/uploads/2022/08/Picture1-36-1024x110.png 1024w, https://www.crowdstrike.com/wp-content/uploads/2022/08/Picture1-36-300x32.png 300w, https://www.crowdstrike.com/wp-content/uploads/2022/08/Picture1-36-768x82.png 768w, https://www.crowdstrike.com/wp-content/uploads/2022/08/Picture1-36-1536x165.png 1536w, https://www.crowdstrike.com/wp-content/uploads/2022/08/Picture1-36-2048x220.png 2048w"}](https://www.crowdstrike.com/wp-content/uploads/2022/08/Picture1-36.png)

(Click to enlarge)
:::

**Challenge \#4: Many Gode Much Chain**
---------------------------------------

*[After thorough analysis of the customer environment, we identified
another executable that was installed on several hosts. We believe it
was left there for persistence and to allow CATAPULT SPIDER to deploy
additional stages on demand. Are you able to understand the
command-and-control mechanism and retrieve a next
stage?]{style="font-weight: 400;"}*

*[Note that we believe the executable was deployed several months
ago.]{style="font-weight: 400;"}*

[Along with the challenge description, an executable named
]{style="font-weight: 400;"}`gode.exe`[ is given. Initial review shows
it was compiled using Golang 1.16. As great as Ghidra is as a free and
open source analysis tool, IDA Pro or even IDA Freeware yield much
better results for this Golang executable. For the sake of
reproducibility for those that do not have access to IDA Pro with a
decompiler license, IDA Freeware was used in the
following.]{style="font-weight: 400;"}

### **Overview and Golang Woes**

[After loading the binary in IDA, the
]{style="font-weight: 400;"}`main_main()`[` function` can be decompiled
using the cloud-based decompiler. The function first decodes a number of
hexadecimal strings and stores them in variables that are named
]{style="font-weight: 400;"}`recipientPublicKey`[,
]{style="font-weight: 400;"}`recipientSecretKey`[ and
]{style="font-weight: 400;"}`senderPublicKey`[, indicating that we may
have to deal with asymmetric encryption at some
point:]{style="font-weight: 400;"}

::: {#attachment_128661 .wp-caption .alignnone style="width: 4312px"}
[![](./catapult-spider-adversary-quest-walkthrough-2022_files/Picture1-37.png){.wp-image-128661
.size-full width="4302" height="558"
sizes="(max-width: 4302px) 100vw, 4302px"
srcset="https://www.crowdstrike.com/wp-content/uploads/2022/08/Picture1-37.png 4302w, https://www.crowdstrike.com/wp-content/uploads/2022/08/Picture1-37-300x39.png 300w, https://www.crowdstrike.com/wp-content/uploads/2022/08/Picture1-37-1024x133.png 1024w, https://www.crowdstrike.com/wp-content/uploads/2022/08/Picture1-37-768x100.png 768w, https://www.crowdstrike.com/wp-content/uploads/2022/08/Picture1-37-1536x199.png 1536w, https://www.crowdstrike.com/wp-content/uploads/2022/08/Picture1-37-2048x266.png 2048w"}](./catapult-spider-adversary-quest-walkthrough-2022_files/Picture1-37.png)

(Click to enlarge)
:::

[Next, the program seems to set various fields of a
]{style="font-weight: 400;"}[[structure]{style="font-weight: 400;"}](https://pkg.go.dev/github.com/btcsuite/btcd/peer#config)[
that is then used in a call to
]{style="font-weight: 400;"}`NewOutBoundPeer()`[:]{style="font-weight: 400;"}

::: {#attachment_128662 .wp-caption .alignnone style="width: 2522px"}
[![](./catapult-spider-adversary-quest-walkthrough-2022_files/Picture1-38.png){.wp-image-128662
.size-full width="2512" height="760"
sizes="(max-width: 2512px) 100vw, 2512px"
srcset="https://www.crowdstrike.com/wp-content/uploads/2022/08/Picture1-38.png 2512w, https://www.crowdstrike.com/wp-content/uploads/2022/08/Picture1-38-300x91.png 300w, https://www.crowdstrike.com/wp-content/uploads/2022/08/Picture1-38-1024x310.png 1024w, https://www.crowdstrike.com/wp-content/uploads/2022/08/Picture1-38-768x232.png 768w, https://www.crowdstrike.com/wp-content/uploads/2022/08/Picture1-38-1536x465.png 1536w, https://www.crowdstrike.com/wp-content/uploads/2022/08/Picture1-38-2048x620.png 2048w"}](./catapult-spider-adversary-quest-walkthrough-2022_files/Picture1-38.png)

(Click to enlarge)
:::

[According to the documentation,
]{style="font-weight: 400;"}`NewOutboundPeer()`[ is used to connect to a
new BitCoin peer-to-peer node. However, the second argument to the
function is the string
]{style="font-weight: 400;"}`seed.multidoge.org:22556`[, which contains
the hostname and port number of one of the
]{style="font-weight: 400;"}[[Dogecoin seed
nodes]{style="font-weight: 400;"}](https://github.com/dogecoin/dogecoin/blob/31afd133119dd2e15862d46530cb99424cf564b0/src/chainparams.cpp#L164)[.]{style="font-weight: 400;"}

[While many plaintext strings found throughout the program indicate that
it seems to be using
]{style="font-weight: 400;"}[[btcd]{style="font-weight: 400;"}](https://github.com/btcsuite/btcd)[
--- a Bitcoin implementation in Golang --- Dogecoin uses almost the same
]{style="font-weight: 400;"}[[peer-to-peer networking
protocol]{style="font-weight: 400;"}](https://en.bitcoin.it/wiki/Protocol_documentation)[
as Bitcoin, so it is plausible that the adversary used btcd to implement
a Dogecoin client. The various fields that are set at the end define
callbacks that are called when messages of certain types are received.
Noteworthy are the two callbacks ]{style="font-weight: 400;"}`OnTx()`
(`off_849BB8`) and `OnBlock()` (`off_849BB0`) that are called when the
peer-to-peer client receives new transaction information or new block
information. While `OnBlock()`[ looks pretty complicated at first, at
the end it seems to repeatedly call
]{style="font-weight: 400;"}`tryDecrypt()`[ and then
]{style="font-weight: 400;"}`handlePayload()`[ in a loop, which is
essentially all that ]{style="font-weight: 400;"}`OnTx()`[ does
once:]{style="font-weight: 400;"}

![](./catapult-spider-adversary-quest-walkthrough-2022_files/Picture1-39.png){.alignnone
.size-full .wp-image-128663 width="1485" height="512"
sizes="(max-width: 1485px) 100vw, 1485px"
srcset="https://www.crowdstrike.com/wp-content/uploads/2022/08/Picture1-39.png 1485w, https://www.crowdstrike.com/wp-content/uploads/2022/08/Picture1-39-300x103.png 300w, https://www.crowdstrike.com/wp-content/uploads/2022/08/Picture1-39-1024x353.png 1024w, https://www.crowdstrike.com/wp-content/uploads/2022/08/Picture1-39-768x265.png 768w"}

[Since Bitcoin blocks typically contain several transactions, we'll
assume that ]{style="font-weight: 400;"}`OnBlock()`[ iterates over all
transactions in a block, and then tries to decrypt them somehow to
retrieve a payload, and finally do something with the decrypted payload,
while ]{style="font-weight: 400;"}`OnTx()`[ will do that for single
transactions when they are received.
]{style="font-weight: 400;"}`OnTx()`[ has the following prototype
according to the ]{style="font-weight: 400;"}[[btcd
implementation]{style="font-weight: 400;"}](https://github.com/btcsuite/btcd/blob/v0.23.1/peer/peer.go#L121)[:]{style="font-weight: 400;"}

![](./catapult-spider-adversary-quest-walkthrough-2022_files/Picture1-40.png){.alignnone
.size-full .wp-image-128664 width="706" height="75"
sizes="(max-width: 706px) 100vw, 706px"
srcset="https://www.crowdstrike.com/wp-content/uploads/2022/08/Picture1-40.png 706w, https://www.crowdstrike.com/wp-content/uploads/2022/08/Picture1-40-300x32.png 300w"}

[Luckily, it seems that IDA automatically identified "local types" for
most types that are used in the program. Even if it did not identify
function prototypes correctly, we can still manually specify the correct
types, which will greatly improve decompilation quality as shown in the
resulting code block:]{style="font-weight: 400;"}

![](./catapult-spider-adversary-quest-walkthrough-2022_files/Picture1-41.png){.alignnone
.size-full .wp-image-128665 width="3272" height="781"
sizes="(max-width: 3272px) 100vw, 3272px"
srcset="https://www.crowdstrike.com/wp-content/uploads/2022/08/Picture1-41.png 3272w, https://www.crowdstrike.com/wp-content/uploads/2022/08/Picture1-41-300x72.png 300w, https://www.crowdstrike.com/wp-content/uploads/2022/08/Picture1-41-1024x244.png 1024w, https://www.crowdstrike.com/wp-content/uploads/2022/08/Picture1-41-768x183.png 768w, https://www.crowdstrike.com/wp-content/uploads/2022/08/Picture1-41-1536x367.png 1536w, https://www.crowdstrike.com/wp-content/uploads/2022/08/Picture1-41-2048x489.png 2048w"}

[IDA seems to assume that all fields
(]{style="font-weight: 400;"}`ptr`[, ]{style="font-weight: 400;"}`len`[,
]{style="font-weight: 400;"}`cap`[) of the
]{style="font-weight: 400;"}`TxOut`[ slice are passed as consecutive
arguments, because they are copied to the stack right before calling
]{style="font-weight: 400;"}`tryDecrypt()`[. Since this is the same as
copying the full structure to the stack, and this would be common in
Golang applications, we'll assume that passing the full slice structure
better captures the semantics of the call and change the call prototype
accordingly to
]{style="font-weight: 400;"}`__int64 __golang main_tryDecrypt(_slice__ptr_wire_TxOut)`[,
yielding the following final decompiled
function:]{style="font-weight: 400;"}

![](./catapult-spider-adversary-quest-walkthrough-2022_files/Picture1-42.png){.alignnone
.size-full .wp-image-128666 width="2189" height="575"
sizes="(max-width: 2189px) 100vw, 2189px"
srcset="https://www.crowdstrike.com/wp-content/uploads/2022/08/Picture1-42.png 2189w, https://www.crowdstrike.com/wp-content/uploads/2022/08/Picture1-42-300x79.png 300w, https://www.crowdstrike.com/wp-content/uploads/2022/08/Picture1-42-1024x269.png 1024w, https://www.crowdstrike.com/wp-content/uploads/2022/08/Picture1-42-768x202.png 768w, https://www.crowdstrike.com/wp-content/uploads/2022/08/Picture1-42-1536x403.png 1536w, https://www.crowdstrike.com/wp-content/uploads/2022/08/Picture1-42-2048x538.png 2048w"}

[This also improves the decompiler output for
]{style="font-weight: 400;"}`tryDecrypt()`[. Since library functions in
the binary are easily identifiable by name, we follow all functions
called (directly or indirectly) by
]{style="font-weight: 400;"}`OnTx()`[, look up their function prototypes
in either public source code or documentation where possible and also
make sure these prototypes are set correctly in IDA to further improve
the decompiler results. This is especially important for return types as
will be illustrated later when discussing the
]{style="font-weight: 400;"}`decodeAddress()`[ function. Another
challenge was that Golang appears to be reusing the same stack areas for
multiple different variables, which confused the decompiler at times. We
did not find an easy way around this and in the end tried to
successively use different variable layouts that would be correct for
the parts of a function that we were interested in. Another option to
explore might be to manually create one big union that covers all stack
variable allocations over time.]{style="font-weight: 400;"}

[After solving these issues and improving some of the decompiler output
as described, we got a relatively good understanding of what the binary
does. The general behavior is as follows:]{style="font-weight: 400;"}

1.  [It connects to the Dogecoin peer-to-peer network and sets callbacks
    to process transactions or blocks that it receives from the
    network.]{style="font-weight: 400;"}
2.  [The callbacks process each arriving transaction and try to decrypt
    a payload using ]{style="font-weight: 400;"}`tryDecrypt()`[, which
    uses ]{style="font-weight: 400;"}`decodeAddress()`[ to process
    Dogecoin addresses in transactions.]{style="font-weight: 400;"}
3.  [The payload is then processed using
    ]{style="font-weight: 400;"}`handlePayload()`[.]{style="font-weight: 400;"}

### **decodeAddress()**

[Since understanding ]{style="font-weight: 400;"}`decodeAddress()`[
helps in understanding ]{style="font-weight: 400;"}`tryDecrypt()`[,
we'll provide its analysis results first, before focusing on the
decryption routine. After initial decompilation, fixing some variable
types and renaming some variables, the
]{style="font-weight: 400;"}`decodeAddress()`[ looks like the following
just before returning:]{style="font-weight: 400;"}

![](./catapult-spider-adversary-quest-walkthrough-2022_files/Picture1-43.png){.alignnone
.size-full .wp-image-128669 width="2081" height="783"
sizes="(max-width: 2081px) 100vw, 2081px"
srcset="https://www.crowdstrike.com/wp-content/uploads/2022/08/Picture1-43.png 2081w, https://www.crowdstrike.com/wp-content/uploads/2022/08/Picture1-43-300x113.png 300w, https://www.crowdstrike.com/wp-content/uploads/2022/08/Picture1-43-1024x385.png 1024w, https://www.crowdstrike.com/wp-content/uploads/2022/08/Picture1-43-768x289.png 768w, https://www.crowdstrike.com/wp-content/uploads/2022/08/Picture1-43-1536x578.png 1536w, https://www.crowdstrike.com/wp-content/uploads/2022/08/Picture1-43-2048x771.png 2048w"}

[We see an object that looks like a slice structure is populated with a
pointer and a new length and capacity value. However, when looking at
the disassembly, we'll see that after setting the
]{style="font-weight: 400;"}`ptr`[ field, some more variables are
written to the stack as return values (a peculiarity of the Golang
calling convention). However, these writes do not appear in the
decompiler output:]{style="font-weight: 400;"}

![](./catapult-spider-adversary-quest-walkthrough-2022_files/Picture1-44.png){.alignnone
.size-full .wp-image-128670 width="1060" height="970"
sizes="(max-width: 1060px) 100vw, 1060px"
srcset="https://www.crowdstrike.com/wp-content/uploads/2022/08/Picture1-44.png 1060w, https://www.crowdstrike.com/wp-content/uploads/2022/08/Picture1-44-300x275.png 300w, https://www.crowdstrike.com/wp-content/uploads/2022/08/Picture1-44-1024x937.png 1024w, https://www.crowdstrike.com/wp-content/uploads/2022/08/Picture1-44-768x703.png 768w"}

[In fact, these variables are fetched from the stack by the calling
function right after the call as shown below, supporting the hypothesis
that they are extra return values.]{style="font-weight: 400;"}

![](./catapult-spider-adversary-quest-walkthrough-2022_files/Picture1-45-1024x591.png){.alignnone
.size-large .wp-image-128671 width="1024" height="591"
sizes="(max-width: 1024px) 100vw, 1024px"
srcset="https://www.crowdstrike.com/wp-content/uploads/2022/08/Picture1-45-1024x591.png 1024w, https://www.crowdstrike.com/wp-content/uploads/2022/08/Picture1-45-300x173.png 300w, https://www.crowdstrike.com/wp-content/uploads/2022/08/Picture1-45-768x444.png 768w, https://www.crowdstrike.com/wp-content/uploads/2022/08/Picture1-45.png 1077w"}

[Our hypothesis is that IDA ignores these stack writes because it deems
them irrelevant. Since we see them used, however, it is likely that
]{style="font-weight: 400;"}`decodeAddress()`[ returns multiple values
and we can model this in IDA by creating a struct with one field for
each of the values and using that as the function's return value. Since
the values returned appear to be a slice, followed by the high and low
nibble that are extracted from some value, as well as an error object,
the following struct was created:]{style="font-weight: 400;"}

![](./catapult-spider-adversary-quest-walkthrough-2022_files/Picture1-46-1024x187.png){.alignnone
.size-large .wp-image-128672 width="1024" height="187"
sizes="(max-width: 1024px) 100vw, 1024px"
srcset="https://www.crowdstrike.com/wp-content/uploads/2022/08/Picture1-46-1024x187.png 1024w, https://www.crowdstrike.com/wp-content/uploads/2022/08/Picture1-46-300x55.png 300w, https://www.crowdstrike.com/wp-content/uploads/2022/08/Picture1-46-768x140.png 768w, https://www.crowdstrike.com/wp-content/uploads/2022/08/Picture1-46-1536x280.png 1536w, https://www.crowdstrike.com/wp-content/uploads/2022/08/Picture1-46-2048x374.png 2048w"}

[Assigning this struct as the return type does indeed improve the
decompiler output since IDA no longer treats the stack writes as dead or
irrelevant code:]{style="font-weight: 400;"}

::: {#attachment_128673 .wp-caption .alignnone style="width: 1832px"}
[![](./catapult-spider-adversary-quest-walkthrough-2022_files/Picture1-47.png){.wp-image-128673
.size-full width="1822" height="960"
sizes="(max-width: 1822px) 100vw, 1822px"
srcset="https://www.crowdstrike.com/wp-content/uploads/2022/08/Picture1-47.png 1822w, https://www.crowdstrike.com/wp-content/uploads/2022/08/Picture1-47-300x158.png 300w, https://www.crowdstrike.com/wp-content/uploads/2022/08/Picture1-47-1024x540.png 1024w, https://www.crowdstrike.com/wp-content/uploads/2022/08/Picture1-47-768x405.png 768w, https://www.crowdstrike.com/wp-content/uploads/2022/08/Picture1-47-1536x809.png 1536w"}](./catapult-spider-adversary-quest-walkthrough-2022_files/Picture1-47.png)

(Click to enlarge)
:::

[Taking a step back now and looking at the whole
]{style="font-weight: 400;"}`decodeAddress()`[ function, we see it takes
a transaction output address as an input, and first decodes it using
]{style="font-weight: 400;"}[[`github.com/gcash/bchutil/base58/CheckDecode()`]{style="font-weight: 400;"}](https://pkg.go.dev/github.com/btcsuite/btcutil/base58#CheckDecode)[.
This method takes a
]{style="font-weight: 400;"}[[Base58Check]{style="font-weight: 400;"}](https://en.bitcoin.it/wiki/Base58Check_encoding)[
encoded value, decodes it while also validating a checksum, and then
returns the first byte of the decoded value as a version byte and the
remainder of the decoded data as the actual decoded
result.]{style="font-weight: 400;"}

`decodeAddress()`[ then proceeds to verify that the byte string starting
at offset 5 of the result matches the CRC32 sum stored in bytes 1
through 4. If that succeeds, it returns the byte string starting at
offset 5, the aforementioned low and high nibble of byte 0, as well as
an error object:]{style="font-weight: 400;"}

::: {#attachment_128674 .wp-caption .alignnone style="width: 1553px"}
[![](./catapult-spider-adversary-quest-walkthrough-2022_files/Picture1-48.png){.wp-image-128674
.size-full width="1543" height="1206"
sizes="(max-width: 1543px) 100vw, 1543px"
srcset="https://www.crowdstrike.com/wp-content/uploads/2022/08/Picture1-48.png 1543w, https://www.crowdstrike.com/wp-content/uploads/2022/08/Picture1-48-300x234.png 300w, https://www.crowdstrike.com/wp-content/uploads/2022/08/Picture1-48-1024x800.png 1024w, https://www.crowdstrike.com/wp-content/uploads/2022/08/Picture1-48-768x600.png 768w, https://www.crowdstrike.com/wp-content/uploads/2022/08/Picture1-48-1536x1201.png 1536w"}](./catapult-spider-adversary-quest-walkthrough-2022_files/Picture1-48.png)

(Click to enlarge)
:::

[This should now allow us to find relevant transactions quite easily by
validating whether the integer value stored in bytes 1 through 4 of an
address in a transaction output matches the CRC32 of the remaining bytes
starting at offset 5. The following Python script can be used with a
local dogecoin client's RPC API to iterate backwards through all blocks
to find matching transactions and addresses:]{style="font-weight: 400;"}

::: {#attachment_128675 .wp-caption .alignnone style="width: 1505px"}
[![](./catapult-spider-adversary-quest-walkthrough-2022_files/Picture1-49.png){.wp-image-128675
.size-full width="1495" height="1425"
sizes="(max-width: 1495px) 100vw, 1495px"
srcset="https://www.crowdstrike.com/wp-content/uploads/2022/08/Picture1-49.png 1495w, https://www.crowdstrike.com/wp-content/uploads/2022/08/Picture1-49-300x286.png 300w, https://www.crowdstrike.com/wp-content/uploads/2022/08/Picture1-49-1024x976.png 1024w, https://www.crowdstrike.com/wp-content/uploads/2022/08/Picture1-49-768x732.png 768w"}](./catapult-spider-adversary-quest-walkthrough-2022_files/Picture1-49.png)

(Click to enlarge)
:::

[Going backwards from the most current block, this will take a while,
but will eventually identify transaction
]{style="font-weight: 400;"}`3241053003923663f34fe81e6866aa627ae4c8f346a33faeacd9702776d00af7`[
with the following addresses:]{style="font-weight: 400;"}

-   `D6ae35GG4EuSbmcNnhToV2gFzrGExuEwNd`
-   `D7yEcBybpjT6842et9G6aDTfMF5XwDdPxn`
-   `D9SPzhsdbyFB5Gt5HCK2ZCbMFy76NkHair`
-   `D9dncUBWQ4LYZcTFjcFzY9GTKBoteeLhAg`

### **tryDecrypt()**

[The function ]{style="font-weight: 400;"}`tryDecrypt()`[ receives a
slice of transaction outputs. It iterates over all of these outputs and
first extracts their so-called
]{style="font-weight: 400;"}`ScriptPubKey`[ (called
]{style="font-weight: 400;"}`PkScript`[ in the btcd library) and the
corresponding destination Dogecoin address from them (simplified from
the decompiler output):]{style="font-weight: 400;"}

::: {#attachment_128676 .wp-caption .alignnone style="width: 1757px"}
[![](./catapult-spider-adversary-quest-walkthrough-2022_files/Picture1-50.png){.wp-image-128676
.size-full width="1747" height="1125"
sizes="(max-width: 1747px) 100vw, 1747px"
srcset="https://www.crowdstrike.com/wp-content/uploads/2022/08/Picture1-50.png 1747w, https://www.crowdstrike.com/wp-content/uploads/2022/08/Picture1-50-300x193.png 300w, https://www.crowdstrike.com/wp-content/uploads/2022/08/Picture1-50-1024x659.png 1024w, https://www.crowdstrike.com/wp-content/uploads/2022/08/Picture1-50-768x495.png 768w, https://www.crowdstrike.com/wp-content/uploads/2022/08/Picture1-50-1536x989.png 1536w"}](./catapult-spider-adversary-quest-walkthrough-2022_files/Picture1-50.png)

(Click to enlarge)
:::

[These addresses are then decoded using the
]{style="font-weight: 400;"}`decodeAddress()`[ function. As described
previously, it returns a byte slice starting from byte 5 of the
Base58Check decoded DogeCoin address, two integer values, and an error
object. The integer values appear to denote an index and a length that
are subsequently used to copy the byte slice to a specific position
within a larger byte slice:]{style="font-weight: 400;"}

::: {#attachment_128678 .wp-caption .alignnone style="width: 1580px"}
[![](./catapult-spider-adversary-quest-walkthrough-2022_files/Picture1-51.png){.wp-image-128678
.size-full width="1570" height="1577"
sizes="(max-width: 1570px) 100vw, 1570px"
srcset="https://www.crowdstrike.com/wp-content/uploads/2022/08/Picture1-51.png 1570w, https://www.crowdstrike.com/wp-content/uploads/2022/08/Picture1-51-300x300.png 300w, https://www.crowdstrike.com/wp-content/uploads/2022/08/Picture1-51-1019x1024.png 1019w, https://www.crowdstrike.com/wp-content/uploads/2022/08/Picture1-51-150x150.png 150w, https://www.crowdstrike.com/wp-content/uploads/2022/08/Picture1-51-768x771.png 768w, https://www.crowdstrike.com/wp-content/uploads/2022/08/Picture1-51-1529x1536.png 1529w"}](./catapult-spider-adversary-quest-walkthrough-2022_files/Picture1-51.png)

(Click to enlarge)
:::

[Once all transaction outputs have been processed in this way, the first
24 bytes of the larger byte slice are used as a nonce that is used
together with the keys previously observed in
]{style="font-weight: 400;"}`main_main()`[ to decrypt the remaining
bytes using
]{style="font-weight: 400;"}`golang.org/x/crypto/nacl/box.Open()`[:]{style="font-weight: 400;"}

![](./catapult-spider-adversary-quest-walkthrough-2022_files/Picture1-52.png){.alignnone
.size-full .wp-image-128679 width="2075" height="681"
sizes="(max-width: 2075px) 100vw, 2075px"
srcset="https://www.crowdstrike.com/wp-content/uploads/2022/08/Picture1-52.png 2075w, https://www.crowdstrike.com/wp-content/uploads/2022/08/Picture1-52-300x98.png 300w, https://www.crowdstrike.com/wp-content/uploads/2022/08/Picture1-52-1024x336.png 1024w, https://www.crowdstrike.com/wp-content/uploads/2022/08/Picture1-52-768x252.png 768w, https://www.crowdstrike.com/wp-content/uploads/2022/08/Picture1-52-1536x504.png 1536w, https://www.crowdstrike.com/wp-content/uploads/2022/08/Picture1-52-2048x672.png 2048w"}

[The following Python program implements the decryption routine and can
be used to properly extract the encrypted data from the previously
identified addresses and decrypt it:]{style="font-weight: 400;"}

::: {#attachment_128680 .wp-caption .alignnone style="width: 1480px"}
[![](./catapult-spider-adversary-quest-walkthrough-2022_files/Picture1-53.png){.wp-image-128680
.size-full width="1470" height="1858"
sizes="(max-width: 1470px) 100vw, 1470px"
srcset="https://www.crowdstrike.com/wp-content/uploads/2022/08/Picture1-53.png 1470w, https://www.crowdstrike.com/wp-content/uploads/2022/08/Picture1-53-237x300.png 237w, https://www.crowdstrike.com/wp-content/uploads/2022/08/Picture1-53-810x1024.png 810w, https://www.crowdstrike.com/wp-content/uploads/2022/08/Picture1-53-768x971.png 768w, https://www.crowdstrike.com/wp-content/uploads/2022/08/Picture1-53-1215x1536.png 1215w"}](./catapult-spider-adversary-quest-walkthrough-2022_files/Picture1-53.png)

(Click to enlarge)
:::

[Using this script on the previously mentioned addresses will yield six
decrypted bytes:]{style="font-weight: 400;"}

![](./catapult-spider-adversary-quest-walkthrough-2022_files/Picture1-54-1024x183.png){.alignnone
.size-large .wp-image-128682 width="1024" height="183"
sizes="(max-width: 1024px) 100vw, 1024px"
srcset="https://www.crowdstrike.com/wp-content/uploads/2022/08/Picture1-54-1024x183.png 1024w, https://www.crowdstrike.com/wp-content/uploads/2022/08/Picture1-54-300x54.png 300w, https://www.crowdstrike.com/wp-content/uploads/2022/08/Picture1-54-768x137.png 768w, https://www.crowdstrike.com/wp-content/uploads/2022/08/Picture1-54-1536x274.png 1536w, https://www.crowdstrike.com/wp-content/uploads/2022/08/Picture1-54-2048x366.png 2048w"}

### **handlePayload()**

[This information will be passed to
]{style="font-weight: 400;"}`handlePayload()`[, which essentially
interprets the first four bytes as an IPv4 address and the last two
bytes as a port that it uses to construct a URL to download and execute
]{style="font-weight: 400;"}`shibetoshi.exe`[ (decompiler listing
simplified):]{style="font-weight: 400;"}

::: {#attachment_128683 .wp-caption .alignnone style="width: 1868px"}
[![](./catapult-spider-adversary-quest-walkthrough-2022_files/Picture1-55.png){.wp-image-128683
.size-full width="1858" height="1110"
sizes="(max-width: 1858px) 100vw, 1858px"
srcset="https://www.crowdstrike.com/wp-content/uploads/2022/08/Picture1-55.png 1858w, https://www.crowdstrike.com/wp-content/uploads/2022/08/Picture1-55-300x179.png 300w, https://www.crowdstrike.com/wp-content/uploads/2022/08/Picture1-55-1024x612.png 1024w, https://www.crowdstrike.com/wp-content/uploads/2022/08/Picture1-55-768x459.png 768w, https://www.crowdstrike.com/wp-content/uploads/2022/08/Picture1-55-1536x918.png 1536w"}](./catapult-spider-adversary-quest-walkthrough-2022_files/Picture1-55.png)

(Click to enlarge)
:::

[The aforementioned decrypted payload contains the IP address
]{style="font-weight: 400;"}`95.216.185.231`[ and the port
]{style="font-weight: 400;"}`8080`[, resulting in the following next
stage URL:]{style="font-weight: 400;"}

`http://95.216.185.231:8080/shibetoshi.exe`

### **Never Gode Give Wow Up**

[This executable is quite simple. All it does is open the following URL
using the system's default URL handler:]{style="font-weight: 400;"}

`https://www.youtube.com/watch?v=dQw4w9WgXcQ#CS{n3v3r_d0g3_giv3_w0w_up}`

[The fragment identifier includes the flag:]{style="font-weight: 400;"}

`CS{n3v3r_d0g3_giv3_w0w_up}`

**Final Remarks**
-----------------

[This concludes the CrowdStrike Intelligence Adversary Quest 2022. This
blog post was about the CATAPULT SPIDER track, where players had to
analyze an email containing a malicious CHM file that automatically
executes code and deploys CATAPULT SPIDER's ransomware when opened. The
second challenge was about analyzing a second stage, a control panel
installed on the system of victims, where a vulnerability allowed
unlocking of the victim machine. In the third challenge of this track,
players were asked to analyze and break the cryptography used by the
ransomware to restore the victim's encrypted files without paying the
ransom. The final challenge was about reverse-engineering another binary
used by CATAPULT SPIDER as a persistence mechanism, which utilized the
Dogecoin Blockchain for command and control.]{style="font-weight: 400;"}

[We hope you enjoyed the Adversary Quest and prepare well for the next
one. Feel free to drop us an email at
]{style="font-weight: 400;"}[[adversaryquest\@crowdstrike.com]{style="font-weight: 400;"}](mailto:adversaryquest@crowdstrike.com)[
--- especially if you published a writeup, want to provide some feedback
or have any questions. ]{style="font-weight: 400;"}[[Also note that
CrowdStrike is constantly hiring talented cybersecurity
professionals!]{style="font-weight: 400;"}](https://crowdstrike.wd5.myworkdayjobs.com/en-US/crowdstrikecareers?Job_Family=1408861ee6e201d67af3e0f6b000d60b)

#### Additional Resources

-   *Read Part 2 of this blog series, ["Adversary Quest 2022
    Walkthrough, Part 2: Four TABLOID JACKAL
    Challenges."](https://www.crowdstrike.com/blog/tabloid-jackal-adversary-quest-walkthrough-2022/)*
-   *Learn more about the adversaries CrowdStrike tracks by exploring
    the[Adversary Universe](https://adversary.crowdstrike.com/).*
-   *To stay ahead of today's adversaries, read the[CrowdStrike 2022
    Global Threat
    Report](https://www.crowdstrike.com/global-threat-report/).*
-   *[Get a full-featured free trial of CrowdStrike Falcon
    Prevent](https://go.crowdstrike.com/try-falcon-prevent.html)and
    learn how true next-gen AV performs against today's most
    sophisticated threats.*
:::

<div>

-   [[]{.fa-brands .fa-twitter}
    Tweet](https://twitter.com/share?text=Adversary+Quest+2022+Walkthrough%2C+Part+1%3A+Four+CATAPULT+SPIDER+Challenges&url=https://www.crowdstrike.com/blog/catapult-spider-adversary-quest-walkthrough-2022/){.tweet-btn}
-   [[]{.fa-brands .fa-linkedin}
    Share](https://www.linkedin.com/shareArticle?mini=true&url=https://www.crowdstrike.com/blog/catapult-spider-adversary-quest-walkthrough-2022/&title=Adversary+Quest+2022+Walkthrough%2C+Part+1%3A+Four+CATAPULT+SPIDER+Challenges){.li-btn}

</div>

[![](./catapult-spider-adversary-quest-walkthrough-2022_files/breaches-stop-here-post-cta.jpeg){.post_cta}](https://go.crowdstrike.com/try-falcon-prevent.html)

##### Related Content

::: {.row .recent_articles}
[](https://www.crowdstrike.com/blog/tabloid-jackal-adversary-quest-walkthrough-2022/){.col-12
.col-md-4 .recent_articles_item}

::: {.post_image}
![](./catapult-spider-adversary-quest-walkthrough-2022_files/0722_03_AdversaryQuest_2022_Hacktivist_TABLOID-JACKAL_Blog_1060x698.jpeg)
:::

::: {.post_info}
###### Adversary Quest 2022 Walkthrough, Part 2: Four TABLOID JACKAL Challenges

::: {.excerpt}
:::
:::

[](https://www.crowdstrike.com/blog/callback-malware-campaigns-impersonate-crowdstrike-and-other-cybersecurity-companies/){.col-12
.col-md-4 .recent_articles_item}

::: {.post_image}
![](./catapult-spider-adversary-quest-walkthrough-2022_files/0622_03_Gartner-Security-Risk-Management-Summit_Blog.jpeg)
:::

::: {.post_info}
###### Callback Malware Campaigns Impersonate CrowdStrike and Other Cybersecurity Companies

::: {.excerpt}
:::
:::

[](https://www.crowdstrike.com/blog/how-crowdstrike-traces-the-evolution-of-ecrime/){.col-12
.col-md-4 .recent_articles_item}

::: {.post_image}
![](./catapult-spider-adversary-quest-walkthrough-2022_files/Falcon-X-Recon-featured-image-1.jpeg)
:::

::: {.post_info}
###### Tales from the Dark Web: How Tracking eCrime's Underground Economy Improves Defenses

::: {.excerpt}
:::
:::
:::
:::

::: {.col-12 .col-lg-4 .sidebar}
::: {.blog_subsection}
::: {.blog_section_subtitle}
::: {.title}
Categories
:::
:::
:::

::: {#blog_category_sidebar_item .blog_featured_category_list}
-   [](https://www.crowdstrike.com/blog/category/endpoint-protection/){.category-sidebar-link
    .d-flex .align-items-center}
    ::: {.category-type .endpoint-protection}
    :::

    ::: {.category_name}
    Endpoint & Cloud Security
    :::

    ::: {.count .ml-auto}
    \(317\)
    :::
-   [](https://www.crowdstrike.com/blog/category/engineering-and-technology/){.category-sidebar-link
    .d-flex .align-items-center}
    ::: {.category-type .engineering-and-technology}
    :::

    ::: {.category_name}
    Engineering & Tech
    :::

    ::: {.count .ml-auto}
    \(63\)
    :::
-   [](https://www.crowdstrike.com/blog/category/executive-viewpoint/){.category-sidebar-link
    .d-flex .align-items-center}
    ::: {.category-type .executive-viewpoint}
    :::

    ::: {.category_name}
    Executive Viewpoint
    :::

    ::: {.count .ml-auto}
    \(125\)
    :::
-   [](https://www.crowdstrike.com/blog/category/from-the-front-lines/){.category-sidebar-link
    .d-flex .align-items-center}
    ::: {.category-type .from-the-front-lines}
    :::

    ::: {.category_name}
    From The Front Lines
    :::

    ::: {.count .ml-auto}
    \(167\)
    :::
-   [](https://www.crowdstrike.com/blog/category/identity-protection/){.category-sidebar-link
    .d-flex .align-items-center}
    ::: {.category-type .identity-protection}
    :::

    ::: {.category_name}
    Identity Protection
    :::

    ::: {.count .ml-auto}
    \(22\)
    :::
-   [](https://www.crowdstrike.com/blog/category/observability-and-log-management/){.category-sidebar-link
    .d-flex .align-items-center}
    ::: {.category-type .observability-and-log-management}
    :::

    ::: {.category_name}
    Observability & Log Management
    :::

    ::: {.count .ml-auto}
    \(70\)
    :::
-   [](https://www.crowdstrike.com/blog/category/people-culture/){.category-sidebar-link
    .d-flex .align-items-center}
    ::: {.category-type .people-culture}
    :::

    ::: {.category_name}
    People & Culture
    :::

    ::: {.count .ml-auto}
    \(82\)
    :::
-   [](https://www.crowdstrike.com/blog/category/remote-workplace/){.category-sidebar-link
    .d-flex .align-items-center}
    ::: {.category-type .remote-workplace}
    :::

    ::: {.category_name}
    Remote Workplace
    :::

    ::: {.count .ml-auto}
    \(20\)
    :::
-   [](https://www.crowdstrike.com/blog/category/threat-intel-research/){.category-sidebar-link
    .d-flex .align-items-center}
    ::: {.category-type .threat-intel-research}
    :::

    ::: {.category_name}
    Research & Threat Intel
    :::

    ::: {.count .ml-auto}
    \(148\)
    :::
-   [](https://www.crowdstrike.com/blog/tech-center/){.category-sidebar-link
    .d-flex .align-items-center}
    ::: {.category-type .tech-center}
    :::

    ::: {.category_name}
    Tech Center
    :::

    ::: {.count .ml-auto}
    \(126\)
    :::
:::

::: {.social}
###### Connect with Us

::: {.social_icons}
[[]{.fa-brands .fa-twitter}](https://www.twitter.com/CrowdStrike)
[[]{.fa-brands .fa-facebook}](https://www.facebook.com/CrowdStrike)
[[]{.fa-brands
.fa-linkedin}](https://www.linkedin.com/company/crowdstrike)
[[]{.fa-brands .fa-youtube}](https://www.youtube.com/user/CrowdStrike)
[[]{.fa .fa-rss}](https://www.crowdstrike.com/blog/feed)
:::
:::

[![](./catapult-spider-adversary-quest-walkthrough-2022_files/Sidebar_EPP_ForresterWave_EDR.jpeg)](https://www.crowdstrike.com/resources/reports/forrester-wave-endpoint-detection-and-response-2022/){.free_trial_sidebar}

::: {#sideBarFeaturedArticles}
::: {.featured_articles_sidebar}
###### Featured Articles

[](https://www.crowdstrike.com/blog/why-xdr-should-be-on-your-soc-roadmap/){.post}

::: {.title}
Why XDR Should Be on Your Roadmap for SOC Success
:::

::: {.date}
August 16, 2022
:::

[](https://www.crowdstrike.com/blog/crowdstrike-wins-frost-and-sullivans-global-technology-innovation-leadership-award/){.post}

::: {.title}
CrowdStrike Wins Technology Innovation Leadership Award, Continues
Dominance in Endpoint Security Market
:::

::: {.date}
August 16, 2022
:::

[](https://www.crowdstrike.com/blog/the-anatomy-of-wiper-malware-part-1/){.post}

::: {.title}
The Anatomy of Wiper Malware, Part 1: Common Techniques
:::

::: {.date}
August 12, 2022
:::

[](https://www.crowdstrike.com/blog/patch-tuesday-analysis-august-2022/){.post}

::: {.title}
August 2022 Patch Tuesday: 17 Critical CVEs and Two Zero-Days, One Under
Active Exploitation
:::

::: {.date}
August 11, 2022
:::
:::
:::

::: {.subscribe_cta}
###### SUBSCRIBE

Sign up now to receive the latest notifications and updates from
CrowdStrike.

[Sign
Up](https://www.crowdstrike.com/blog/catapult-spider-adversary-quest-walkthrough-2022/#){.button
.white-text .white-outline .white-text-hover .dark-red-background-hover
.dark-red-outline-hover}
:::

::: {.demo_cta}
![](./catapult-spider-adversary-quest-walkthrough-2022_files/red-falcon.svg)

###### See CrowdStrike Falcon in Action

Detect, prevent, and respond to attacks--- even malware-free
intrusions---at any stage, with next-generation endpoint protection.

[See Demo](https://www.crowdstrike.com/see-demo/){.button .white-text
.red-background .red-outline .white-text-hover
.dark-red-background-hover .dark-red-outline-hover}
:::
:::
:::

::: {.post_nav .row}
::: {.col-12}
::: {.links}
[]{.fa .fa-angle-double-left} [Why XDR Must Start with EDR: Join the
Discussion with CrowdStrike and Guest Forrester
Research](https://www.crowdstrike.com/blog/experts-discuss-why-xdr-must-start-with-edr/)
:::

::: {.links}
[Log Management and
Observability](https://www.crowdstrike.com/blog/tech-center/log-management-observability/)
[]{.fa .fa-angle-double-right}
:::
:::
:::
:::

::: {#freeTrialCta .section .blog-free-trial-cta}
::: {.container}
::: {.row}
::: {.col-12}
::: {.content}
TRY CROWDSTRIKE FREE FOR 15 DAYS {#try-crowdstrike-free-for-15-days .free-trial-header}
================================

[GET STARTED WITH A FREE
TRIAL](https://www.crowdstrike.com/blog/catapult-spider-adversary-quest-walkthrough-2022/#){#freeTrialOpenTrigger
.button .white-text .red-background .red-outline .white-text-hover
.dark-red-background-hover .dark-red-outline-hover}
:::
:::
:::
:::

::: {#freeTrialContent .free-trial-content-wrapper .unstuck style="display: none;"}
::: {.container}
[X]{#freeTrialCloseTrigger .free-trial-close-trigger .red}
:::

::: {.container .free-trial-iframe-wrapper}
:::
:::
:::
:::

::: {.container}
::: {.row}
::: {.col-md-12 .top}
[ [](https://www.crowdstrike.com/){.red} ]{.footer-logo}

-   [](https://twitter.com/CrowdStrike)
-   [](https://www.facebook.com/CrowdStrike/)
-   [](https://www.linkedin.com/company/crowdstrike)
-   [](http://www.youtube.com/user/CrowdStrike)
:::

::: {.col-md-12 .bottom}
-   Copyright  2022 CrowdStrike
-   [Privacy](https://www.crowdstrike.com/privacy-notice/)
-   [Request Info](https://www.crowdstrike.com/request-information/)
-   [Blog](https://www.crowdstrike.com/blog)
-   [Contact Us](https://www.crowdstrike.com/contact-us/)
-   1.888.512.8906
:::
:::
:::
:::
:::
:::

::: {#addsearch-results style="position: absolute; display: none; z-index: 9999999;"}
::: {#addsearch-top-close style="display: none;"}
[]{#addsearch-top-resultcount}[X](https://www.crowdstrike.com/blog/catapult-spider-adversary-quest-walkthrough-2022/# "Close"){#addsearch-topcloselink}
:::

::: {#addsearch-results-right onmouseover="addsearch.resultsRightHover();addsearch.setActiveResultItem(addsearch.activeResultItem);"}
::: {#addsearch-suggestions}
:::

+-----------------------------------------------------------------------+
| ::: {style="max-height:520px; overflow:hidden; text-align: center;"}  |
| ![Screen                                                              |
| capture](data:image/gif;base64,R0lGODlhAQABAPAAAAAA                   |
| AAAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw==){#addsearch-results-pic-img} |
| :::                                                                   |
|                                                                       |
| ::: {#addsearch-edit}                                                 |
| :::                                                                   |
+-----------------------------------------------------------------------+

::: {#addsearch-scroll}
::: {#addsearch-scroll-handle}
:::
:::
:::

::: {#addsearch-results-mid onscroll="addsearch.scroll(this); return false;" onmousedown="addsearch.mousedown(this);"}
::: {#addsearch-result-item style="display: none;"}
::: {#addsearch-result-item-i .addsearch-result-item-sub onmouseover="addsearch.setActiveResultItem(this.id);" img=""}
<div>

[\$h2](https://www.crowdstrike.com/blog/catapult-spider-adversary-quest-walkthrough-2022/#)
-------------------------------------------------------------------------------------------

\$hl

</div>
:::
:::

![Loading..](data:image/gif;base64,R0lGODlhAQABAPAAAAAAAAAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw==){#addsearch-loading}
:::

::: {#addsearch-results-bottom}
[![AddSearch.com - Instant search for your
website](data:image/gif;base64,R0lGODlhAQABAPAAAAAAAAAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw==){#addsearch-logo-img
width="97"}](http://www.addsearch.com/?utm_source=customer&utm_medium=referer&utm_campaign=customer){#addsearch-logo}[X](https://www.crowdstrike.com/blog/catapult-spider-adversary-quest-walkthrough-2022/# "Close"){#addsearch-closelink}
:::
:::

::: {#onetrust-consent-sdk}
::: {.onetrust-pc-dark-filter .ot-hide .ot-fade-in}
:::

::: {#onetrust-pc-sdk .otPcTab .ot-hide .ot-fade-in role="alertdialog" aria-modal="true" aria-describedby="ot-pc-desc" lang="en" aria-label="Cookie Preference Center"}
::: {.ot-pc-header role="presentation"}
::: {.ot-pc-logo role="img" aria-label="Company Logo" style="background-image: url(\"https://cdn.cookielaw.org/logos/c109dae9-46f3-4e91-a59e-7844ef645107/cad7e755-8c86-4939-8df1-4d68f074f0fc/53cb332e-5cc4-44a8-9590-9e086136bfe9/CS_Logos_2020_InlineRed_b.png\");
                    background-position: left;"}
:::

::: {.ot-title-cntr}
Cookie Preference Center {#ot-pc-title}
------------------------

::: {.ot-close-cntr}
:::
:::
:::

::: {#ot-pc-content .ot-pc-scrollbar .ot-sdk-row}
::: {.ot-sdk-container .ot-grps-cntr .ot-sdk-column}
::: {.ot-sdk-four .ot-sdk-columns .ot-tab-list aria-label="Cookie Categories"}
-   ::: {.ot-active-menu .category-menu-switch-handler role="tab" tabindex="0" aria-selected="true" aria-controls="ot-tab-desc"}
    ### Your Privacy {#ot-pvcy-txt}
    :::

-   ::: {.category-menu-switch-handler role="tab" tabindex="-1" aria-selected="false" aria-controls="ot-desc-id-C0001"}
    ### Strictly Necessary Cookies {#ot-header-id-C0001}
    :::

-   ::: {.category-menu-switch-handler role="tab" tabindex="-1" aria-selected="false" aria-controls="ot-desc-id-C0003"}
    ### Functional Cookies {#ot-header-id-C0003}
    :::

-   ::: {.category-menu-switch-handler role="tab" tabindex="-1" aria-selected="false" aria-controls="ot-desc-id-C0002"}
    ### Performance Cookies {#ot-header-id-C0002}
    :::

-   ::: {.category-menu-switch-handler role="tab" tabindex="-1" aria-selected="false" aria-controls="ot-desc-id-C0004"}
    ### Targeting Cookies {#ot-header-id-C0004}
    :::
:::

::: {.ot-tab-desc .ot-sdk-eight .ot-sdk-columns}
::: {#ot-tab-desc .ot-desc-cntr tabindex="0" role="tabpanel" aria-labelledby="ot-pvcy-hdr"}
#### Your Privacy {#ot-pvcy-hdr}

When you visit any website, it may store or retrieve information on your
browser, mostly in the form of cookies. This information might be about
you, your preferences or your device and is mostly used to make the site
work as you expect it to. The information does not usually directly
identify you, but it can give you a more personalized web experience.
Because we respect your right to privacy, you can choose not to allow
some types of cookies. Click on the different category headings to find
out more and change our default settings. However, blocking some types
of cookies may impact your experience of the site and the services we
are able to offer.\
[More
information.](https://cookiepedia.co.uk/giving-consent-to-cookies){.privacy-notice-link}
:::

::: {#ot-desc-id-C0001 .ot-desc-cntr .ot-hide .ot-always-active-group role="tabpanel" tabindex="0"}
::: {.ot-grp-hdr1}
#### Strictly Necessary Cookies {#strictly-necessary-cookies .ot-cat-header}

::: {.ot-tgl-cntr}
::: {.ot-always-active}
Always Active
:::
:::
:::

These cookies are necessary for the website to function and cannot be
switched off in our systems. This includes diagnostic functions such as
identifying 404 errors and monitoring page load speed. They are usually
only set in response to actions made by you which amount to a request
for services, such as setting your privacy preferences, logging in or
filling in forms. You can set your browser to block or alert you about
these cookies, but some parts of the site will not then work. These
cookies do not store any personally identifiable information.

::: {.ot-hlst-cntr}
Cookies Details
:::
:::

::: {#ot-desc-id-C0003 .ot-desc-cntr .ot-hide role="tabpanel" tabindex="0"}
::: {.ot-grp-hdr1}
#### Functional Cookies {#functional-cookies .ot-cat-header}

::: {.ot-tgl}
[]{.ot-switch-nob aria-checked="false" role="switch"} [Functional
Cookies]{.ot-label-txt}
:::

::: {.ot-tgl-cntr}
:::
:::

These cookies enable the website to provide enhanced functionality and
personalisation. They may be set by us or by third party providers whose
services we have added to our pages. If you do not allow these cookies
then some or all of these services may not function properly.

::: {.ot-hlst-cntr}
Cookies Details
:::
:::

::: {#ot-desc-id-C0002 .ot-desc-cntr .ot-hide role="tabpanel" tabindex="0"}
::: {.ot-grp-hdr1}
#### Performance Cookies {#performance-cookies .ot-cat-header}

::: {.ot-tgl}
[]{.ot-switch-nob aria-checked="false" role="switch"} [Performance
Cookies]{.ot-label-txt}
:::

::: {.ot-tgl-cntr}
:::
:::

These cookies allow us to count visits and traffic sources so we can
measure and improve the performance of our site. They help us to know
which pages are the most and least popular and see how visitors move
around the site. All information these cookies collet is aggregated and
therefore anonymous. If you do not allow these cookies we will not know
when you have visited our site, and will not be able to monitor its
performance.

::: {.ot-hlst-cntr}
Cookies Details
:::
:::

::: {#ot-desc-id-C0004 .ot-desc-cntr .ot-hide role="tabpanel" tabindex="0"}
::: {.ot-grp-hdr1}
#### Targeting Cookies {#targeting-cookies .ot-cat-header}

::: {.ot-tgl}
[]{.ot-switch-nob aria-checked="false" role="switch"} [Targeting
Cookies]{.ot-label-txt}
:::

::: {.ot-tgl-cntr}
:::
:::

These cookies may be set through our site by our advertising partners.
They may be used by those companies to build a profile of your interests
and show you relevant adverts on other sites. They do not store directly
personal information, but are based on uniquely identifying your browser
and internet device. If you do not allow these cookies, you will
experience less targeted advertising.

::: {.ot-hlst-cntr}
Cookies Details
:::
:::
:::
:::
:::

::: {#ot-pc-lst .section .ot-hide .ot-enbl-chr}
::: {.ot-lst-cntr .ot-pc-scrollbar}
::: {#ot-pc-hdr}
::: {#ot-lst-title}
Back Button

### Back
:::

::: {.ot-lst-subhdr}
::: {#ot-search-cntr}
:::

::: {#ot-fltr-cntr}
Filter Button
:::
:::
:::

::: {#ot-lst-cnt .section .ot-pc-scrollbar}
::: {.ot-sdk-row}
::: {.ot-sdk-column}
::: {#ot-sel-blk}
::: {.ot-sel-all}
::: {.ot-sel-all-hdr}
[Consent]{.ot-consent-hdr} [Leg.Interest]{.ot-li-hdr}
:::

::: {.ot-sel-all-chkbox}
::: {#ot-selall-hostcntr .ot-chkbox}
[checkbox label]{.ot-label-txt} [label]{.ot-label-status}
:::

::: {#ot-selall-vencntr .ot-chkbox}
[checkbox label]{.ot-label-txt} [label]{.ot-label-status}
:::

::: {#ot-selall-licntr .ot-chkbox}
[checkbox label]{.ot-label-txt} [label]{.ot-label-status}
:::
:::
:::
:::

-   ::: {.section .ot-acc-hdr}
    ::: {.ot-tgl-cntr}
    ::: {.ot-host-hdr}
    ###  {#section .ot-host-name}

    ####  {#section-1 .ot-host-desc}
    :::
    :::

    ::: {.ot-host-notice}
    View Third Party Cookies
    :::
    :::

    ::: {.ot-acc-txt}
    ::: {.ot-host-opts}
    -   <div>

        <div>

        Name

        </div>

        <div>

        cookie name

        </div>

        </div>
    :::
    :::
:::
:::
:::
:::

::: {#ot-anchor}
:::

::: {#ot-fltr-modal .section}
::: {#ot-fltr-cnt}
Clear

::: {.ot-fltr-scrlcnt .ot-pc-scrollbar}
::: {.ot-fltr-opts}
::: {.ot-fltr-opt}
::: {.ot-chkbox}
[checkbox label]{.ot-label-txt} [label]{.ot-label-status}
:::
:::
:::

::: {.ot-fltr-btns}
Apply

Cancel
:::
:::
:::
:::
:::

::: {.ot-pc-footer}
::: {.ot-btn-container}
Confirm My Choices

::: {.ot-btn-subcntr}
Allow All
:::
:::

::: {.ot-pc-footer-logo}
[![Powered by
Onetrust](./catapult-spider-adversary-quest-walkthrough-2022_files/poweredBy_ot_logo.svg "Powered by OneTrust Opens in a new Tab")](https://www.onetrust.com/products/cookie-consent/)
:::
:::

[]{.ot-scrn-rdr aria-atomic="true" aria-live="polite"}
:::
:::

::: {#drift-frame-chat .drift-conductor-item .drift-frame-chat .drift-frame-chat-align-right .with-transition .drift-has-chat style="right: 12px; width: 400px !important; max-width: none; position: fixed; z-index: 2147483647; max-height: 0px; bottom: 88px; visibility: hidden; min-width: 320px; height: 100% !important; opacity: 0;" aria-hidden="true" tabindex="-1"}
:::

::: {#drift-frame-controller .drift-conductor-item .drift-frame-controller .drift-frame-controller-align-right .drift-has-chat style="right: 24px; width: 360px; max-width: none; position: fixed; z-index: 2147483647; height: 100px; bottom: 24px;"}
:::
